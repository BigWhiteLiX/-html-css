define("shihuo:widget/js/avalon.js",function(e,n,r){!function(e,t){"object"==typeof n&&"object"==typeof r?r.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof n?n.avalon=t():e.avalon=t()}(this,function(){function e(t){return new e.init(t)}function n(t,n,r){t[r.name]=e.parseExpr(r)}function r(e){return/\[native code\]/.test(e)}function a(e,t,n){var r="for(var "+e+"i=0,n = this.length; i < n; i++){"+t.replace("_","((i in this) && fn.call(scope,this[i],i,this))")+"}"+n;return Function("fn,scope",r)}function o(e){return e?e==e.document&&e.document!=e:!1}function i(e){return Lr.test(jr.call(e))}function s(t,n){if(!t||"object"!==e.type(t)||t.nodeType||e.isWindow(t))return!1;try{if(t.constructor&&!gr.call(t,"constructor")&&!gr.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(r){return!1}if(Fr)for(n in t)return gr.call(t,n);for(n in t);return void 0===n||gr.call(t,n)}function c(e){return"[object Object]"===jr.call(e)&&Object.getPrototypeOf(e)===Object.prototype}function l(e){if(!e)return!1;var t=e.length;if(t===t>>>0){var n=jr.call(e).slice(8,-1);if(Hr.test(n))return!1;if("Array"===n)return!0;try{return{}.propertyIsEnumerable.call(e,"length")===!1?Dr.test(e.item||e.callee):!0}catch(r){return!e.window}}return!1}function u(e){this.size=0,this.limit=e,this.head=this.tail=void 0,this._keymap={}}function d(t){return t.uuid||(t.uuid=e.makeHashCode("e"))}function f(e){return e.uuid||(e.uuid="_"+ ++Rr)}function p(t){for(var n in t)if(e.ohasOwn.call(t,n)){var r=t[n];"function"==typeof p.plugins[n]?p.plugins[n](r):p[n]=r}return this}function v(e,t,n,r){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var a=isFinite(+e)?+e:0,o=isFinite(+t)?Math.abs(t):3,i=r||",",s=n||".",c="",l=function(e,t){var n=Math.pow(10,t);return""+(Math.round(e*n)/n).toFixed(t)};return c=(o?l(a,o):""+Math.round(a)).split("."),c[0].length>3&&(c[0]=c[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,i)),(c[1]||"").length<o&&(c[1]=c[1]||"",c[1]+=new Array(o-c[1].length+1).join("0")),c.join(s)}function m(e){return e.replace(Gr,"").replace(Qr,function(e){var t=e.toLowerCase().match(/<(\w+)\s/);if(t){var n=ea[t[1]];n&&(e=e.replace(n,function(e,t,n){var r=n.charAt(0);return t+"="+r+"javascript:void(0)"+r}))}return e.replace(Jr," ").replace(/\s+/g," ")})}function h(e){return parseInt(e,10)||0}function y(e,t,n){var r="";for(0>e&&(r="-",e=-e),e=""+e;e.length<t;)e="0"+e;return n&&(e=e.substr(e.length-t)),r+e}function g(e,t,n,r){return function(a){var o=a["get"+e]();return(n>0||o>-n)&&(o+=n),0===o&&-12===n&&(o=12),y(o,t,r)}}function _(e,t){return function(n,r){var a=n["get"+e](),o=(t?"SHORT"+e:e).toUpperCase();return r[o][a]}}function b(e){var t=-1*e.getTimezoneOffset(),n=t>=0?"+":"";return n+=y(Math[t>0?"floor":"ceil"](t/60),2)+y(Math.abs(t%60),2)}function w(e,t){return e.getHours()<12?t.AMPMS[0]:t.AMPMS[1]}function x(e,t){var n,r,a=x.locate,o="",i=[];if(t=t||"mediumDate",t=a[t]||t,"string"==typeof e)if(/^\d+$/.test(e))e=h(e);else if(ra.test(e))e=+RegExp.$1;else{var s=e.trim(),c=[0,0,0,0,0,0,0],l=new Date(0);s=s.replace(/^(\d+)\D(\d+)\D(\d+)/,function(e,t,n,r){var a=4===r.length?[r,t,n]:[t,n,r];return c[0]=h(a[0]),c[1]=h(a[1])-1,c[2]=h(a[2]),""});var u=l.setFullYear,d=l.setHours;s=s.replace(/[T\s](\d+):(\d+):?(\d+)?\.?(\d)?/,function(e,t,n,r,a){return c[3]=h(t),c[4]=h(n),c[5]=h(r),a&&(c[6]=Math.round(1e3*parseFloat("0."+a))),""});var f=0,p=0;s=s.replace(/Z|([+-])(\d\d):?(\d\d)/,function(e,t,n,r){return u=l.setUTCFullYear,d=l.setUTCHours,t&&(f=h(t+n),p=h(t+r)),""}),c[3]-=f,c[4]-=p,u.apply(l,c.slice(0,3)),d.apply(l,c.slice(3)),e=l}for("number"==typeof e&&(e=new Date(e));t;)r=na.exec(t),r?(i=i.concat(r.slice(1)),t=i.pop()):(i.push(t),t=null);return i.forEach(function(t){n=ta[t],o+=n?n(e,a):t.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),o}function $(t,n,r){var a=e.type(t);if("array"!==a&&"object"!==a)throw"orderBy只能处理对象或数组";var o=r&&0>r?-1:1;if("string"==typeof n){var i=n;n=function(e){return e&&e[i]}}t=T(t),t.forEach(function(e){e.order=n(e.value,e.key)}),t.sort(function(e,t){var n=e.order,r=t.order;return Number.isNaN(n)&&Number.isNaN(r)?0:n===r?0:n>r?o:-o});var s="array"===a,c=s?[]:{};return k(c,t,function(e){s?c.push(e.value):c[e.key]=e.value})}function C(t,n){var r=e.type(t);if("array"!==r&&"object"!==r)throw"filterBy只能处理对象或数组";var a=e.slice(arguments,2),o=e.type(n);if("function"===o)var i=n;else{if("string"!==o&&"number"!==o)return t;if(""===n)return t;var s=new RegExp(e.escapeRegExp(n),"i");i=function(e){return s.test(e)}}t=T(t).filter(function(e,t){return!!i.apply(e,[e.value,t].concat(a))});var c="array"===r,l=c?[]:{};return k(l,t,function(e){c?l.push(e.value):l[e.key]=e.value})}function E(t,n,r){if(e.isObject(t)&&!Array.isArray(t)){var a=[];return k(a,n,function(e){a.push(t.hasOwnProperty(e)?t[e]:r?r[e]:"")})}return t}function A(t,n,r){var a=e.type(t);if("array"!==a&&"object"!==a)throw"limitBy只能处理对象或数组";if("number"!=typeof n)return t;if(Number.isNaN(n))return t;"object"===a&&(t=T(t));var o=t.length;n=Math.floor(Math.min(o,n)),r="number"==typeof r?r:0,0>r&&(r=Math.max(0,o+r));for(var i=[],s=r;o>s&&i.length!==n;s++)i.push(t[s]);var c="array"===a;if(c)return i;var l={};return k(l,i,function(e){l[e.key]=e.value})}function k(e,t,n){for(var r=0,a=t.length;a>r;r++)n(t[r]);return e}function T(t){var n=[],r=0;return e.each(t,function(e,t){n[r++]={value:t,key:e}}),n}function O(e){return null==e?"":String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function N(e){return e}function M(t){this.nodeName="#text",this.nodeValue=t,this.skipContent=!e.config.rexpr.test(t)}function j(e){this.nodeName="#comment",this.nodeValue=e}function S(e,t,n){this.nodeName=e,this.props=t,this.children=n}function D(e){return e!==!1&&Object(e)!==e}function L(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function V(e){document.styleSheets.length<31?document.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)"):document.styleSheets[0].addRule(".rvml","behavior:url(#default#VML)");var t=e.split(":");1===t.length&&t.unshift("v");var n=t[1],r=t[0];return document.namespaces[r]||document.namespaces.add(r,"urn:schemas-microsoft-com:vml"),document.createElement("<"+r+":"+n+' class="rvml">')}function F(e){this.nodeName="#document-fragment",this.children=e}function H(e,t){if(1===e.nodeType){var n=e.nodeName.toLowerCase();"object"===n?e.parentNode&&(e.outerHTML=t.outerHTML):"input"===n&&ma.test(t.nodeName)?(e.defaultChecked=e.checked=t.checked,e.value!==t.value&&(e.value=t.value)):"option"===n?e.defaultSelected=e.selected=t.defaultSelected:("input"===n||"textarea"===n)&&(e.defaultValue=t.defaultValue)}}function P(e){return"undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName("*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll("*"):[]}function I(e){for(var n=e.cloneNode(!0),r=P(e),a=0;a<r.length;a++)H(t[a],r[a]);return n}function B(e,t){try{for(;t=t.parentNode;)if(t===e)return!0;return!1}catch(n){return!1}}function z(e){if(!("classList"in e)){e.classList={node:e};for(var t in ya)e.classList[t.slice(1)]=ya[t]}return e.classList}function R(e){var t=e.nodeName;return t.toLowerCase()===t&&e.scopeName&&""===e.outerText}function q(t,n){if(t&&1===t.nodeType){n.dynamic["ms-attr"]=1;var r=n["ms-attr"];for(var a in r){var o=r[a];if(void 0!=o)if("href"===a||"src"===a){if(t.hasAttribute||(o=String(o).replace(xa,"&")),t[a]=o,Or.chrome&&"EMBED"===t.tagName){var i=t.parentNode,s=document.createComment("ms-src");i.replaceChild(s,t),i.replaceChild(t,s)}}else if(0===a.indexOf("data-"))t.setAttribute(a,o);else{var c=ga[a]||a;if("boolean"==typeof t[c]&&(t[c]=!!o),o===!1){t.removeAttribute(c);continue}var l=wa.test(t)?!1:!e.modern&&R(t)?!0:a in t.cloneNode(!1);l?t[c]=o+"":t.setAttribute(a,o)}}}}function U(e,t){if(e.offsetWidth<=0){if(Ma.test(ka["@:get"](e,"display"))){var n={node:e};for(var r in Na)n[r]=e.style[r],e.style[r]=Na[r];t.push(n)}var a=e.parentNode;a&&1===a.nodeType&&U(a,t)}}function Y(e){return e.window||e.defaultView||e.parentWindow||!1}function W(e){var t=e.tagName.toLowerCase();return"input"===t&&ma.test(e.type)?"checked":t}function Z(t,n,r){var a=t.getAttribute("avalon-events");if(a&&(t.disabled!==!0||"click"!==n)){var o=[],i=qa[n]||(qa[n]=new RegExp("\\b"+n+"\\:([^,\\s]+)","g"));a.replace(i,function(e,t){return o.push(t),e}),o.length&&r.push({elem:t,uuids:o})}t=t.parentNode;var s=e.gestureEvents||{};t&&t.getAttribute&&(za[n]||s[n])&&Z(t,n,r)}function X(t){t=new G(t);var n=t.type,r=t.target,a=[];Z(r,n,a);for(var o,i,s,c=0;(s=a[c++])&&!t.cancelBubble;){var l=t.currentTarget=s.elem;for(o=0;i=s.uuids[o++];){if(Ya){Ya=!1;break}var u=e.eventListeners[i];if(u){var d=Ua.test(i)?s.elem._ms_context_:0;if(d&&d.$hashcode===!1)return e.unbind(r,n,u);var f=u.call(d||r,t,l._ms_local);f===!1&&(t.preventDefault(),t.stopPropagation())}}}}function K(t){var n=Wr.getAttribute("delegate-events")||"";if(-1===n.indexOf(t)){var r=n.match(e.rword)||[];r.push(t),Wr.setAttribute("delegate-events",r.join(",")),e._nativeBind(Wr,t,X,!!Wa[t])}}function G(e){if(e.originalEvent)return e;for(var t in e)Za.test(t)||"function"==typeof e[t]||(this[t]=e[t]);this.target||(this.target=e.srcElement);this.target;this.fixEvent(),this.timeStamp=new Date-0,this.originalEvent=e}function J(e){var t={},n=e.nodeName.toLowerCase();if(t.nodeName=n,t.dom=e,"#"===n.charAt(0)){var r=e.nodeValue;/\S/.test(r)&&(t.nodeValue=r)}else{var a=Q(e);Ja[n]&&(t.isVoidTag=!0),t.children=tt(e),a&&("selectedIndex"in a&&(e.selectedIndex=a.selectedIndex,delete a.selectedIndex),t.props=a)}return t}function Q(e){for(var t=e.attributes,n={},r=0,a=t.length;a>r;r++){var o=t[r];if(o.specified){var i=o.name;":"===i.charAt(0)&&(i=i.replace(eo,"ms-")),n[i]=o.value}}Qa.test(e.nodeName)&&(n.type=e.type);var s=e.style.cssText;return s&&(n.style=s),"select-one"===n.type&&(n.selectedIndex=e.selectedIndex),et(n)?null:n}function et(e){for(var t in e)return!1;return!0}function tt(e){var t=[],n=e.firstChild;if(!n)return t;do{var r=n.nextSibling;switch(n.nodeType){case 1:var a=n.getAttributeNode(":for")||n.getAttributeNode("ms-for");if(a){var o=document.createComment("ms-for:"+a.value),i=document.createComment("ms-for-end:");n.removeAttributeNode(a),e&&(e.insertBefore(i,n.nextSibling),e.insertBefore(o,n)),t.push(J(o),J(n),J(i))}else t.push(J(n));break;case 3:if(/\S/.test(n.nodeValue))t.push(J(n));else{var s=n.parentNode;s&&s.removeChild(n)}break;case 8:t.push(J(n))}n=r}while(n);return t}function nt(t){for(var n,r=0;n=t[r++];)if(1===n.nodeType){var a=rt(n),o=e.vmodels[a];if(o&&!o.$element){if(o.$element=n,e.serverTemplates&&e.serverTemplates[a]){var i=e.serverTemplates[a],s=e.speedUp(e.lexer(i)),c=e.render(s),l=c(o),u=e.vdom(l[0],"toDOM");o.$element=u,u.vtree=l,o.$render=c,n.parentNode.replaceChild(u,n),e.diff(l,l);continue}var l=[J(n)],d=new Date;n.vtree=e.speedUp(l);var f=new Date;no&&e.log("构建虚拟DOM耗时",f-d,"ms"),o.$render=e.render(n.vtree),e.scopes[o.$id]={vmodel:o,local:{},isTemp:!0};var p=new Date;no&&p-f>100&&(e.log("构建当前vm的$render方法耗时 ",p-f,"ms\n","如果此时间太长,达100ms以上\n","建议将当前ms-controller拆分成多个ms-controller,减少每个vm管辖的区域"),no=!1),e.rerenderStart=p,e.batch(a)}else a||nt(n.childNodes)}}function rt(e){return e.getAttribute("ms-controller")||e.getAttribute(":controller")}function at(e,t){var n,r=t.split(".")[0];try{e.hasOwnProperty(r)&&(n=e.$accessors?e.$accessors[r].get.heirloom.__vmodel__:Object.getOwnPropertyDescriptor(e,r).get.heirloom.__vmodel__)}catch(a){}return n||e}function ot(t,n){var r=t.indexOf(".*")>0||"*"===t,a=r?this:ot.adjust(this,t),o=this.$events,i=o[t]||(o[t]=[]);return r&&(i.reg=i.reg||st(t)),ct(r,o,t),a!==this&&ct(r,this.$events,t),e.Array.ensure(i,n),function(){e.Array.remove(i,n)}}function it(t,n,r,a,o,i){if(t&&t.length)try{for(i=i||t.length-1;i>=0;i--){var s=t[i];s.call(n,a,o,r)}}catch(c){i-1>0&&it(t,n,r,a,o,i-1),e.log(c,r)}}function st(e){var t=e.split(".");return new RegExp("^"+t.map(function(e){return"*"===e?"(?:[^.]+)":e}).join("\\.")+"$","i")}function ct(e,t,n){e&&(t.__fuzzy__?-1===t.__fuzzy__.indexOf(","+n)&&(t.__fuzzy__+=","+n):t.__fuzzy__=n)}function lt(e,t){e.length!==t&&e.notify("length",e.length,t,!0)}function ut(t,n,r){return"$"===t.charAt(0)||r[t]||fo.test(e.type(n))||n&&n.nodeName&&n.nodeType>0}function dt(t,n,r,a){var o=e.type(t);switch(o){case"array":return oo.arrayFactory(t,n,r,a);case"object":if(n&&n.$id){if(++e.suspendUpdate,n.$track!==Object.keys(t).sort().join(";;"))var i=oo.slaveFactory(n,t,r,a);else i=n;for(var s in t)io[s]||(i[s]=t[s]);return--e.suspendUpdate,i}return i=oo.masterFactory(t,r,a);default:return t}}function ft(e,t,n){function r(){return a}var a=0/0;return r.heirloom=n,{get:r,set:function(o){if(a!==o){var i=a;i&&i.$model&&(i=i.$model);var s=n.__vmodel__;if(o&&"object"==typeof o&&(o=dt(o,a,n,{pathname:t,id:e})),a=o,this.$hashcode&&s){if(s.$events.$$dirty$$=!0,s.$events.$$wait$$)return;n!==s.$events&&(r.heirloom=s.$events),ht(r.$decompose,t,o,i),-1===t.indexOf("*")&&it(r.heirloom[t],s,t,o,i),mt(e+"",s,t,o,i),yt(r.heirloom,s,t,o,i),s.$events.$$dirty$$=!1,pt(s.$id)}}},enumerable:!0,configurable:!0}}function pt(t){e.rerenderStart=new Date;var n=t.indexOf(".");e.batch(n>0?t.slice(0,n):t)}function vt(t,n,r,a){if(n&&n.splice){var o=[0,n.length].concat(t);return++e.suspendUpdate,e.callArray=a.pathname,n.splice.apply(n,o),--e.suspendUpdate,n}for(var i in so)t[i]=so[i];t.notify=function(t,n,o,i){var s=r.__vmodel__;if(s){var c=null===t||void 0===t?a.pathname:a.pathname+"."+t;s.$fire(c,n,o),i||r.$$wait$$||e.suspendUpdate||(e.callArray=c,pt(s.$id),delete e.callArray)}};var s=e.makeHashCode("$");a.array=!0,a.hashcode=s,a.id=a.id||s,oo.initViewModel(t,r,{},{},a);for(var c=0,l=t.length;l>c;c++)t[c]=dt(t[c],0,{},{id:t.$id+".*",master:!0});return t}function mt(t,n,r,a,o){if(t.indexOf(".*.")>0){var i=t.match(po),s=e.vmodels[i[1]];if(s){var c=i[2];it(s.$events[c],n,r,a,o)}}}function ht(e,t,n,r){if(e&&e[t]){var a=e[t];if(a.$hashcode){var o=t.replace(/^[^.]+\./,"");o!==t&&it(a.$events[o],a,o,n,r)}else delete e[t]}}function yt(t,n,r,a,o){t.__fuzzy__&&t.__fuzzy__.replace(e.rword,function(e){var i=t[e],s=i.reg;return s&&s.test(r)&&it(i,n,r,a,o),e})}function gt(t){switch(e.type(t)){case"array":for(var n=[],r=0;r<t.length;r++)n[r]=gt(t[r]);return n;case"object":var a={};for(r in t)if("__proxy__"!==r&&"__data__"!==r&&"__const__"!==r&&t.hasOwnProperty(r)){var o=t[r];a[r]=o&&o.nodeType?o:gt(o)}return a;default:return t}}function _t(e,t,n){vo?Object.defineProperty(e,t,{value:n,writable:!0,enumerable:!1,configurable:!0}):e[t]=n}function bt(t,n,r,a,o){o.array?e.modern?Object.defineProperty(t,"$model",mo):t.$model=gt(t):(_t(t,"$accessors",a),_t(t,"hasOwnProperty",function(e){return r[e]===!0}),_t(t,"$track",Object.keys(r).sort().join(";;"))),_t(t,"$id",o.id),_t(t,"$hashcode",o.hashcode),o.master===!0&&(_t(t,"$run",function(){xt.call(t)}),_t(t,"$wait",function(){wt.call(t)}),_t(t,"$element",null),_t(t,"$render",0),n.__vmodel__=t,_t(t,"$events",n),_t(t,"$watch",function(){return ot.apply(t,arguments)}),_t(t,"$fire",function(e,n,r){var a=t.$events[e];it(a,t,e,n,r)}))}function wt(){this.$events.$$wait$$=!0}function xt(){var t=this.$events;if(delete t.$$wait$$,t.$$dirty$$){delete t.$$dirty$$,e.rerenderStart=new Date;var n=this.$id,r=n.indexOf(".");e.batch(r>0?n.slice(0,r):n)}}function $t(){}function Ct(t,n,r){var a={};t.$skipArray&&(a=e.oneObject(t.$skipArray),delete t.$skipArray);var o={};r=r||{},n=n||{};var i={},s=ko("$"),c=r.pathname||"";r.id=r.id||s,r.hashcode=r.hashcode||s;var l,u,d;for(l in t)if(!xo[l]){var f=o[l]=t[l];wo(l,f,a)||(u=r.id+"."+l,d=c?c+"."+l:l,i[l]=$o(u,d,n))}i.$model=Co;var p=new $t;p=Eo(p,i,t);for(l in o)p[l]=o[l],l in a?delete o[l]:o[l]=!0;return Ao(p,n,o,i,r),p}function Et(e,t,n,r){var a={},o={},i={};n=n||{};var s,c,l,u=r.pathname,d=e.$accessors||{};for(s in t)xo[s]||(a[s]=!0,wo(s,t[s],To)?(o[s]=t[s],delete t[s]):d[s]?i[s]=d[s]:(c=r.id+"."+s,l=u?u+"."+s:s,i[s]=$o(c,l,n)));r.hashcode=e.$hashcode||ko("$"),i.$model=Co;var f=new $t;f=Eo(f,i,o);for(s in o)f[s]=o[s];return Ao(f,n,a,i,r),f}function At(t){for(var n,r,a,o={},i={},s={},c={},l=e.slice(arguments),u={},d="function"==typeof this&&this.isWidget,f=0;f<l.length;f++){var p=l[f],v=p.$accessors;for(var n in p)if(p.hasOwnProperty(n)){var m=p[n];"$skipArray"!==n?d&&-1!==l.indexOf(m)?(r=m,a=n):(o[n]=m,i[n]&&e.isObject(m)&&delete i[n],v&&v[n]?i[n]=v[n]:"function"!=typeof o[n]&&(s[n]=1)):Array.isArray(m)&&m.forEach(function(e){u[e]=1})}}"function"==typeof this&&this(o,s);for(n in s)xo[n]||i[n]||wo(n,o[n],u)||(i[n]=$o(t.$id,n,c),i[n].set(o[n]));var h=new $t;h=Eo(h,i,o);for(n in o){if(i[n]||(h[n]=o[n]),d&&r&&i[n]&&r.hasOwnProperty(n)){var y=i[n].get;y.$decompose||(y.$decompose={}),y.$decompose[a+"."+n]=h}n in xo?delete o[n]:o[n]=!0}return Ao(h,c,o,i,{id:t.$id,hashcode:ko("$"),master:!0}),h}function kt(t,n,r){if(r)t.afterChange=t.afterChange||[],e.Array.ensure(t.afterChange,n);else{var a=t.dom;n(t.dom,t,a&&a.parentNode)}}function Tt(t,n){var r=t.ownerDocument,a=t.nodeName,o="_"+a;if(!Tt[o]){var i=r.body.appendChild(r.createElement(a));n=e.css(i,"display"),r.body.removeChild(i),n===jo&&(n="block"),Tt[o]=n}return Tt[o]}function Ot(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t],r=typeof n;if("string"===r||"number"===r||n===!0)e.push(n);else if(Array.isArray(n))e.push(Ot.apply(null,n));else if("object"===r)for(var a in n)n.hasOwnProperty(a)&&n[a]&&e.push(a)}return e.join(" ")}function Nt(t){var n=t.target;e(n).addClass(n.getAttribute(So[t.type])||"")}function Mt(t){var n=t.target,r=So[t.type];e(n).removeClass(n.getAttribute(r)||""),"change-active"!==r&&e(n).removeClass(n.getAttribute("change-active")||"")}function jt(t,n){var r=t.getAttribute("old-change-class"),a=n["ms-class"];r!==a&&(e(t).removeClass(r).addClass(a),t.setAttribute("old-change-class",a))}function St(e,t){for(var n in e)if(e[n]!==t[n])return!0;return!1}function Dt(e){return Fo.test(e)||Lo[e]?qr(e):e}function Lt(e){var t=[];for(var n in e){var r=typeof e[n];if("object"===r)if("props"===n){var a=[];for(var o in e.props){var i=e.props[o];"string"==typeof i&&(i=qr(i)),a.push(Dt(o)+": "+i)}t.push(n+": {"+a.join(",\n")+"}")}else"children"===n&&t.push("children: ["+e[n].map(function(e){return Lt(e)})+"]");else if(e.hasOwnProperty(n)){var s=e[n];"string"===r&&(s=Vo[n]?qr(s):s),t.push(Dt(n)+":"+s)}}return"{\n"+t.join(",\n")+"}"}function Vt(e){e.callback&&e.callback.call(e.vmodel,{type:"changed",target:e.dom},e.local)}function Ft(){var e=this,t=this.__ms_duplex__;if(!e.composing&&e.value!==t.value){if(e.caret)try{var n=t.getCaret(e);t.pos=n}catch(r){}if(t.debounceTime>4){var a=new Date,o=a-t.time||0;t.time=a,o>=t.debounceTime?Ho[t.type].call(t):(clearTimeout(t.debounceID),t.debounceID=setTimeout(function(){Ho[t.type].call(t)},o))}else Ho[t.type].call(t)}}function Ht(t,n){var r={},a=n["ms-duplex"];switch(a.update=Ft,a.type){case"radio":case"checkbox":r.click=Ft;break;case"select":r.change=Ft;break;case"contenteditable":a.isChanged?r.blur=Ft:e.modern?(Ur.webkitURL?r.webkitEditableContentChanged=Ft:Ur.MutationEvent&&(r.DOMCharacterDataModified=Ft),r.input=Ft):(r.keydown=Ut,r.paste=It,r.cut=It,r.focus=qt,r.blur=Rt);break;case"input":a.isChanged?r.change=Ft:(Po&&(r.keyup=Ut),9>Po?(r.propertychange=Pt,r.paste=It,r.cut=It):r.input=Ft,(!Po||Po>9)&&(r.compositionstart=Rt,r.compositionend=qt),Po||/\[native code\]/.test(Ur.Int8Array)||(r.keydown=Ut,r.paste=It,r.cut=It,Ur.netscape&&(r.DOMAutoComplete=Ft)))}/password|text/.test(n.props.type)&&(r.focus=Bt,r.blur=zt,a.getCaret=zo,a.setCaret=Bo);for(var o in r)e.bind(t,o,r[o])}function Pt(e){"value"===e.propertyName&&Ft.call(this,e)}function It(e){var t=this;setTimeout(function(){Ft.call(t,e)},0)}function Bt(){this.caret=!0}function zt(){this.caret=!1}function Rt(){this.composing=!0}function qt(e){this.composing=!1,It.call(this,e)}function Ut(e){var t=e.keyCode;91===t||t>15&&19>t||t>=37&&40>=t||Ft.call(this,e)}function Yt(t,n){var r=t.__ms_duplex__,a=n["ms-rules"];if(a&&!r.validator)for(;t&&1===t.nodeType;){var o=t._ms_validator_;if(o){r.rules=a,r.validator=o,e.Array.ensure(o.fields,r)&&o.addField(r);break}t=t.parentNode}}function Wt(t){for(var n,r=0;n=this.parsers[r++];){var a=e.parsers[n];a&&(t=a.call(this,t))}return t}function Zt(){var e=this.data||{};return this.message.replace(ti,function(t,n){return null==e[n]?"":e[n]})}function Xt(t){return"regexp"===e.type(t)}function Kt(e){if("string"==typeof e&&e){var t=e.split("-");if(3===t.length&&4===t[0].length){var n=~~t[0],r=~~t[1]-1,a=~~t[2],o=new Date(n,r,a);return o.getFullYear()===n&&o.getMonth()===r&&o.getDate()===a}}return!1}function Gt(e){var t=typeof e;return e&&"object"===t?e.$hashcode:t+":"+e}function Jt(e,t,n,r,a,o,i,s){var c=s?Gt(t):e,l={};l[a]=e,l[o]=t;for(var u in n)u in l||(l[u]=n[u]);r(e,t,c,l,i)}function Qt(e,t){var n=e.children.map(function(e){return e["ms-if"]?e.comment:e.dom});return t&&n.forEach(function(t){e.dom.appendChild(t)}),n}function en(e){var t;for(var n in e){var t=n;break}return t?tn(e,t):void 0}function tn(e,t){var n=e[t];if(n){var r=n.arr;if(r){var a=r.pop();return r.length||(n.arr=0),a}return delete e[t],n}}function nn(e,t){var n=t.key;if(e[n]){var r=e[n],a=r.arr||(r.arr=[]);a.push(t)}else e[n]=t}function rn(e,t,n){var r,a={TransitionEvent:"transitionend",WebKitTransitionEvent:"webkitTransitionEnd",OTransitionEvent:"oTransitionEnd",otransitionEvent:"otransitionEnd"};for(var o in a){if(n[o]){r=a[o];break}try{{document.createEvent(o)}r=a[o];break}catch(i){}}if("string"==typeof r)var s=!0,c=!0,l=r;a={AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"};var u;for(o in a)if(n[o]){u=a[o];break}if("string"==typeof u){var d=!0;c=!0;var f=u}return{css:c,animation:d,transition:s,animationEndEvent:f,transitionEndEvent:l,transitionDuration:e,animationDuration:t}}function an(){var e=ui[0];e&&e()}function on(e,t,n){e[t]||(e[t]=n)}function sn(e){var t=fi.test(e)?1e3:1;return parseFloat(e)*t}function cn(e,t,n){var r=e[t];r=Array.isArray(r)?r:"function"==typeof r?[r]:[],r.forEach(function(e){e&&e(n)})}function ln(t){var n=t.toLowerCase();return function(r){var a,o=this.el,i=e(o),s=isFinite(r.stagger)?1e3*r.stagger:0;if(s&&r.staggerKey){var c=pi.get(r.staggerKey)||pi.put(r.staggerKey,{count:0,items:0});c.count++,c.items++}var l=c&&c.count||0,u=function(n){var i=n!==!1;0===--o.__ms_effect_&&(e.unbind(o,li.transitionEndEvent),e.unbind(o,li.animationEndEvent)),o.animating=void 0,a=!0;var s=i?"Done":"Abort";cn(r,"on"+t+s,o),c&&0===--c.items&&(c.count=0),r.queue&&(ui.shift(),an())};cn(r,"onBefore"+t,o),r[n]?r[n](o,function(e){u(e!==!1)}):li.css&&(i.addClass(r[n+"Class"]),"leave"===n?i.removeClass(r.enterClass+" "+r.enterActiveClass):"enter"===n&&i.removeClass(r.leaveClass+" "+r.leaveActiveClass),o.__ms_effect_?o.__ms_effect_++:(i.bind(li.transitionEndEvent,u),i.bind(li.animationEndEvent,u),o.__ms_effect_=1),setTimeout(function(){a=0/0===e.root.offsetWidth,i.addClass(r[n+"ActiveClass"]);var t=Or.getComputedStyle(o),c=t[li.transitionDuration],l=t[li.animationDuration],d=sn(c)||sn(l);0===!d?u(!1):s||setTimeout(function(){a||u(!1)},d+32)},17+s*l))}}function un(e){e.acton||(e.action=e.hook.replace(/^on/,"").replace(/Done$/,"").toLowerCase())}function dn(e){var t="??"+vi++;return mi.map[t]=e,t+" "}function fn(e){var t=mi.map[e];return t}function pn(e){for(var t=vn(e),n=0,r=t.length;r>n;n++)e=e.replace(t[n],dn);return e}function vn(e){for(var t,n=0,r=[],a=0,o=e.length;o>a;a++){var i=e.charAt(a);if(t){if("\\"===i){a+=1;continue}i===t&&(r.push(e.slice(n,a+1)),t=!1)}else"'"===i?(t="'",n=a):'"'===i&&(t='"',n=a)}return r}function mn(e){for(var t,n=!1,r=0,a=0,o=e.length,i=0;o>i;i++){var s=e[i];t?"tr"!==s.nodeName&&s.children?t=!1:(t.children.push(s),r++,e[i]=0):"tr"===(s.type||s.nodeName)&&(t={nodeName:"tbody",children:[]},t.children.push(s),s.type&&delete s.type,n=!0,0===a&&(a=i),e[i]=t)}if(n)for(i=a;o>i&&(0!==e[i]||(e.splice(i,1),i--,r--,0!==r));i++);}function hn(e,t,n){switch(t){case"style":case"script":case"noscript":case"template":case"xmp":e.children=[{nodeName:"#text",skipContent:!0,nodeValue:n}];break;case"textarea":var r=e.props;r.type=t,r.value=n,e.children=[{nodeName:"#text",nodeValue:n}];break;case"option":e.children=[{nodeName:"#text",nodeValue:yn(n)}]}}function yn(e){return String(e).replace(yi,"").trim()}function gn(t){mi.map={},t=pn(t);var n=[];n.last=function(){return n[n.length-1]};var r=[],a=1e5;do{var o=!1;if("<"!==t.charAt(0)){var i=t.indexOf("<");i=-1===i?t.length:i;var s=t.slice(0,i).replace(hi,fn);t=t.slice(i),o={nodeName:"#text",nodeValue:s},wi.test(s)&&bn(o,n,r)}if(!o){var i=t.indexOf("<!--");if(0===i){var c=t.indexOf("-->");-1===c&&e.error("注释节点没有闭合"+t);var s=t.slice(4,c).replace(hi,fn);t=t.slice(c+3),o={nodeName:"#comment",nodeValue:s},bn(o,n,r)}}if(!o){var l=t.match(_i);if(l){var u=l[1].toLowerCase(),d=Ja[u]||"/"===l[3];o={nodeName:u,props:{},children:[],isVoidTag:d};var f=l[2];if(f&&wn(f,o.props),bn(o,n,r),t=t.slice(l[0].length),d)o.end=!0;else if(n.push(o),gi[u]){var p=t.indexOf("</"+u+">"),v=t.slice(0,p).trim();t=t.slice(p),hn(o,u,xn(v))}}}if(!o){var l=t.match(bi);if(l){var u=l[1].toLowerCase(),m=n.last();m?m.nodeName!==u&&e.error(m.nodeName+"没有闭合"):e.error(l[0]+"前面缺少<"+u+">"),o=n.pop(),o.end=!0,t=t.slice(l[0].length)}}if(!o||0===--a)break;o.end&&(_n(o,n,r),delete o.end)}while(t.length);return r}function _n(e,t,n){var r=e.nodeName,a=e.props;"table"===r&&mn(e.children);var o=a["ms-for"];if(o){delete a["ms-for"];var i=t.last(),s=i?i.children:n;s.splice(s.length-1,1,{nodeName:"#comment",nodeValue:"ms-for:"+o,type:r},e,{nodeName:"#comment",nodeValue:"ms-for-end:",type:r})}}function bn(e,t,n){var r=t.last();r?r.children.push(e):n.push(e)}function wn(e,t){for(;e;){var n=$i.exec(e);if(!n)break;var r=n[1],a=n[2]||"";e=e.replace(n[0],""),":"===r.charAt(0)&&(r="ms-"+r.slice(1)),a&&0===a.indexOf("??")&&(a=xn(a).replace(xi,"").slice(1,-1)),r in t||(t[r]=a)}}function xn(t){return e.unescapeHTML(t.replace(hi,fn))}function $n(e,t){for(var n=0;n<e.length;n++){var r=e[n],a=t[n]||e[n];switch(r.nodeName){case"#text":if(r.dynamic){var o=r.nodeValue+"";o!==a.nodeValue&&(a.nodeValue=o,a.dom&&(a.dom.nodeValue=o))}break;case"#comment":r.forExpr?zr["for"].diff(r,a,e,t,n):r.afterChange&&Cn(a,r.afterChange);break;case void 0:$n(r,a);break;case"#document-fragment":$n(r.children,a.children);break;default:if(r.dynamic){var i=n;r["ms-widget"]&&(zr.widget.diff(r,a,"ms-widget",e,t,i),r=e[n],a=t[n]||Ci(),delete r["ms-widget"]),"ms-if"in r&&(zr["if"].diff(r,a,"ms-if",e,t,i),r=e[n],a=t[n]||Ci(),delete r["ms-if"]),En(r,a)}!/^\w/.test(r.nodeName)||r.skipContent||r.isVoidTag||$n(r.children,a.children||[]),a.afterChange&&Cn(a,a.afterChange)}}}function Cn(e,t){if(t.length)for(var n,r=0;n=t[r++];)n(e.dom,e);delete e.afterChange}function En(t,n){try{for(var r in t){var a=r.match(Ei),o=a&&a[1];zr[o]&&zr[o].diff(t,n,r)}}catch(i){e.warn(o,i,i.stack||i.message,"diffProps error")}}function An(t){if(ki)return e.Array.ensure(Ai,t);ki=t;var n=e.scopes[t];if(!n||!document.nodeName||e.suspendUpdate)return ki=null;var r=n.vmodel,a=r.$element,o=a.vtree||[],i=r.$render,s=i(n.vmodel,n.local);n.isTemp&&delete e.scopes[t],e.diff(s,o);var c=Ai.indexOf(ki);if(ki=0,c>-1){var l=Ai.splice(c,1);return An(l[0])}var u=Ai.shift();u&&An(u)}function kn(e,t){var n=[],r={},a="ms-skip"in t,o={};for(var i in t){var s,c=t[i];if(r[i]=t[i],s=i.match(Ti)){if(a)continue;var l=i.replace(s[1],"").split("-");Oi[l[0]]&&l.unshift("on"),"on"===l[0]&&(l[2]=parseFloat(l[2])||0),l.unshift("ms");var u=l[1];if(zr[u]){var d={type:u,param:l[2],name:l.join("-"),expr:c,priority:zr[u].priority||100*u.charCodeAt(0)};"on"===u&&(d.priority+=l[3]),o[d.name]||(o[d.name]=c,n.push(d))}}}return e.props=r,n.sort(Tn),n}function Tn(e,t){return e.priority-t.priority}function On(e,t){for(var n,r=t?[]:["\nvar vnodes = [];"],a=0;n=e[a++];){var o=Nn(n);n.$prepend&&r.push(n.$prepend);var i=n.$append;delete n.$append,delete n.$prepend,o&&r.push(o+"\n"),i&&r.push(i)}return t||r.push("return vnodes\n"),r.join("\n")}function Nn(t){if(!t.nodeName)return!1;switch(t.nodeName){case"#text":return t.dynamic?jn(Dn(t)):Sn(t);case"#comment":var n=t.nodeValue;if(t.forExpr){var r={dynamic:!0,vmodel:"__vmodel__"};for(var a in t)t.hasOwnProperty(a)&&!Di[a]&&(r[a]=t[a]);return e.directives["for"].parse(r,t,t),t.$append+=e.caches[t.signature],Sn(r)}if("ms-for-end:"===n)return t.$append=Sn({nodeName:"#comment",nodeValue:t.signature})+" return vnodes}\n })\n},__local__,vnodes)\n"+Sn({nodeName:"#comment",signature:t.signature,nodeValue:"ms-for-end:"})+"\n","";if(0===n.indexOf("ms-js:")){var o=e.parseExpr({type:"js",expr:n.replace("ms-js:","")})+"\n",i=Sn(t),s=o.match(Si);return s&&s[1]?t.$append=(t.$append||"")+o+"\n__local__."+s[1]+" = "+s[1]+"\n":e.warn(n+" parse fail!"),i}return Sn(t);default:if(!t.dynamic&&t.skipContent)return Sn(t);var r={nodeName:t.nodeName},c=t.props;if(t.dynamic){r.dynamic="{}";var l=kn(r,c);l.map(function(n){return e.directives[n.type].parse(r,t,n),n.name})}else if(c){r.props={};for(var a in c)r.props[a]=c[a]}if(t.isVoidTag)r.isVoidTag=!0;else if(!("children"in r)){var u=t.children;u&&(r.children=t.skipContent?"["+u.map(function(e){return Lt(e)})+"]":1===u.length&&"#text"===u[0].nodeName?u[0].dynamic?"["+Dn(u[0])+"]":"["+Lt(u[0])+"]":"(function(){"+On(u)+"})()")}return t.template&&(r.template=t.template),t.skipContent&&(r.skipContent=!0),Sn(r)}}function Mn(t){return ji.test(t)?t:e.parseExpr({expr:t,type:"text"})}function jn(e){return"vnodes.push("+e+");"}function Sn(e){return jn(Lt(e))}function Dn(e){var t=Ln(e.nodeValue),n="";if(1===t.length)n=Mn(t[0].expr);else{var r=t.map(function(e){return e.type?Mn(e.expr):Mi(e.expr)}).join(" + ");n="String("+r+")"}return'{\nnodeName: "#text",\ndynamic:true,\nnodeValue: '+n+"\n}"}function Ln(t){var n=[];do{var r=t.indexOf(Ni.openTag);r=-1===r?t.length:r;var a=t.slice(0,r);if(/\S/.test(a)&&n.push({expr:e._decode(a)}),t=t.slice(r+Ni.openTag.length)){r=t.indexOf(Ni.closeTag);var a=t.slice(0,r);n.push({expr:e.unescapeHTML(a.replace(Li,"")),type:"text"}),t=t.slice(r+Ni.closeTag.length)}}while(t.length);return n}function Vn(e){return Hi(e),e}function Fn(t){var n=t.nodeName;switch(n){case"#text":return e.config.rexpr.test(t.nodeValue)?t.dynamic=!0:!1;case"#comment":return t.dynamic?!0:!1;case void 0:return!0;default:var r=t.props||{};if("ms-skip"in r)return t.skipContent=!0,!1;var a=!1;if("input"===n)r.type||(r.type="text");else if(/xmp|wbr|template/.test(n))!r["ms-widget"]&&r.is&&(r["ms-widget"]='{is:"'+r.is+'"}');else if("select"===n){var o=r.hasOwnProperty("multiple")?"multiple":"one";r.type=n+"-"+o}else 0===n.indexOf("ms-")&&(r["ms-widget"]||(r.is=n,r["ms-widget"]='{is:"'+n+'"}'));var i=!1;if(r["ms-widget"]){i=!0,Hn(r,"html","widget"),Hn(r,"text","widget");var s=e.mix({},t),c=e.mix({},t.props);delete c["ms-widget"],delete s.isVoidTag,s.nodeName="cheng",s.props=c,t.template=e.vdom(s,"toHTML"),t.isVoidTag||(t.children=[])}r["ms-text"]&&(i=!0,Hn(r,"html","text"),t.isVoidTag||(t.children=[])),r["ms-html"]&&(i=!0,t.isVoidTag||(t.children=[]));var l=!1;for(var u in r)if(l=!0,0===u.indexOf("ms-")){a=!0,t.dynamic={};break}if(l&&(t.props=r),t.children){var d=Hi(t.children);if(d)return delete t.skipContent,!0;i?delete t.skipContent:t.skipContent=!0}return a}}function Hn(t,n,r){t["ms-"+n]&&(e.warn(n,"指令不能与",r,"指令共存于同一个元素"),delete t["ms-"+n])}function Pn(e){for(var t,n=0;t=e[n++];)if(t.props&&t.props["ms-effect"])return!0;return!1}function In(t){var n=t.expr,r=t.type,a=Pi.get(r+":"+n);if(a)return e.shadowCopy(t,a),a.text;mi.map={};var o={},i={},s=n.replace(Zi,dn);s=pn(s),s=s.replace(Bi,dn).replace(Ri,"$1").replace(Ui,"$1__vmodel__.").replace(/(\b[\$\w]+\s*):/g,dn).replace(/\|(\w+)/g,function(e,t){return"|"+dn(t)}).replace(/__vmodel__\.([\$\w\.]+)/g,function(e,t){return o[t]=1,e}),zn(s,i);var c=s.split(zi),l=c.shift(),u=l.replace(hi,fn);if("js"===r)return Bn(t,u,o,i);c.length&&(c=c.map(function(e){var t="(__value__";return e=e.replace(Ii,function(e,n){return/\S/.test(n)&&(t+=","+n),""}).replace(hi,fn),e.replace(/^(\w+)/,'__value__ =  avalon.__format__("$1")')+t+")"}));var d=[];if("on"===r)qi.test(u)&&(u+="($event)"),c=c.map(function(e){return e.replace(/__value__/g,"$event")
}),c.length&&c.push("if($event.$return){\n	return;\n}"),e.modern||(u=u.replace(/__vmodel__\.([^(]+)\(([^)]*)\)/,function(e,t,n){return"__vmodel__."+t+".call(__vmodel__"+(/\S/.test(n)?","+n:"")+")"})),d=["function ($event, __local__){","try{",Rn(i).join("\n"),"	var __vmodel__ = this;","	"+u,"}catch(e){",qn(n,r),"}","}"],c.unshift(2,0);else{if("duplex"===r){var f=["function (__vmodel__,__value__){","try{","	"+u+" = __value__","}catch(e){",qn(n,r).replace("parse","set"),"}","}"];Pi.put("duplex:set:"+t.expr,f.join("\n").replace(hi,fn));var p=["function (__vmodel__){","try{","var __value__ = "+u,c.join("\n"),"return __value__","}catch(e){",qn(n,r).replace("parse","get"),"}","}"].join("\n");return Bn(t,p,i,o)}d=["(function (){","try{","var __value__ = "+u.replace(hi,fn),"text"===r?"return avalon.parsers.string(__value__)":"return __value__","}catch(e){",qn(n,r),'	return ""',"}","})()"],c.unshift(3,0)}return d.splice.apply(d,c),Bn(t,d.join("\n"),i,o)}function Bn(e,t,n,r){t=t.replace(hi,fn);var a={text:t,locals:Object.keys(n).join(","),paths:Object.keys(r).join(",")},o=e.type+":"+e.expr;return e.locals=a.locals,e.paths=a.paths,Pi.put(o,a),t}function zn(t,n){t.replace(/__vmodel__/," ").replace(Yi," ").replace(Wi,function(t){"$event"===t||e.keyMap[t]||(n[t]=1)})}function Rn(t){var n=[];for(var r in t)n.push("var "+r+" = __local__["+e.quote(r)+"]");return n}function qn(t,n){return"	avalon.warn(e, "+e.quote("parse "+n+" binding【 "+t+" 】fail")+")"}function Un(t,n){var r=Array.isArray(t)?On(t):t,a=[];if(n)for(var o in n)a.push("var "+o+" = __local__["+qr(o)+"]");r=r.replace(Xi,"$1");var i="__local__ = __local__ || {};\n"+a.join(";\n")+"\n"+r;try{var s=Function("__vmodel__","__local__",i)}catch(c){e.warn(r,"render parse error")}return s}function Yn(t,n,r,a){function o(e,t){m.forEach(function(n){delete e[n],delete t[n]})}var i=t.nodeName,s=t.props.is;if(!Ki[i]&&!Kn(i))return void e.warn(i+"不合适做组件的标签");var c={};if(n){var l=[].concat(n);l.forEach(function(e){e&&"object"==typeof e&&Gn(c,e.$model||e,!0)})}else l=[];var u=e.components[s];if(u){var d=c.id||c.$id;!d&&es&&(e.warn("warning!",s,"组件最好在ms-widget配置对象中指定全局不重复的$id以提高性能!\n","若在ms-for循环中可以利用 ($index,el) in @array 中的$index拼写你的$id\n","如 ms-widget=\"{is:'ms-button',id:'btn'+$index}\""),es=!1),c.define&&(delete c.define,e.warn("warning! 组件的define配置项已经被废掉"));var f=e.directives.widget.define,p=d||t.props.id||"w"+(new Date-0),v=e.mix(!0,{},u.defaults);Gn(c,v,!1);var m=Qi.concat();o.isWidget=!0;var h=f.apply(o,[t.vmodel,v].concat(l));if(!e.modern)for(var y in h)io[y]||"function"!=typeof h[y]||(h[y]=h[y].bind(h));h.$id=p,e.vmodels[p]=h;for(var g in Ji)c[g]&&c[g].forEach(function(e){h.$watch(g,e)});var _=e.lexer(a),b=_[0];b.children=b.children||[],b.props.is=s,b.props.wid=p,e.speedUp(_);var w=e.render(_,r),x=u.template.trim();"function"==typeof u.getTemplate&&(x=u.getTemplate(h,x));var $=e.lexer(x);$.length>1&&e.error("组件必须用一个元素包起来");var C=u.soleSlot;Xn($,C),e.speedUp($);var E=e.render($),A=Zn+"",k=C?e.quote(C):"null";A=A.replace("XXXXX",Wn(w)).replace("YYYYY",Wn(E)).replace("ZZZZZ",k);var T=A.indexOf("{")+1,O=A.lastIndexOf("}"),N=Function("vm","local",A.slice(T,O));return h.$render=N,t["component-vm:"+s]=h,h.$render=N}}function Wn(e){return e.toString().replace("anonymous","").replace(/\s*\/\*\*\//g,"")}function Zn(){var t=XXXXX(vm,local),n=t[0],r=YYYYY(vm,local),a=r[0];for(var o in n)"children"!==o&&"nodeName"!==o&&("props"===o?e.mix(a.props,n.props):a[o]=n[o]);var i=ZZZZZ,s=e.collectSlots(n,i);return!i||s[i]&&s[i].length||(s[i]=[{nodeName:"#text",nodeValue:vm[i],dynamic:!0}]),e.insertSlots(r,s),delete a.skipAttrs,delete a.skipContent,r}function Xn(e,t){for(var n,r=0;n=e[r];r++)if("slot"===n.nodeName){var a=n.props.name||t;e.splice(r,1,{nodeName:"#comment",nodeValue:"slot:"+a,dynamic:!0,type:a},{nodeName:"#comment",nodeValue:"slot-end:"}),r++}else n.children&&Xn(n.children,t)}function Kn(t){return ts.test(t)||e.components[t]}function Gn(e,t,n){for(var r in t){var a=t[r];Ji[r]?r in e?e[r].push(a):e[r]=[t[r]]:n&&(e[r]=a)}}function Jn(e){for(;e;){if(9===e.nodeType)return!0;e=e.parentNode}return!1}function Qn(t){if(1===t.nodeType&&t.getAttribute("wid")&&!Jn(t)){var n=t.getAttribute("wid"),r=e.scopes[n];if(!r)return;var a=t.getAttribute("ms-controller")||t.getAttribute("ms-important"),o=a&&e.vmodels[a]||r.vmodel;if(o.$fire("onDispose",{type:"dispose",target:t,vmodel:o}),a)return;if(!t.getAttribute("cached")){delete r.vmodel,delete e.scopes[n];var i=t.vtree;er(i);var s=t.getAttribute("is");i&&(i[0][s+"-mount"]=!1,i[0]["component-ready:"+s]=!1)}return!1}}function er(e){for(var t in e){var n=e[t];if(ns.test(n.nodeName)){for(var t in n)0===t.indexOf("ms-on")&&delete n[t];n.children&&er(n.children)}}}function tr(e){setTimeout(function(){Qn(e)},4)}function nr(e){for(var t,n=0;t=e[n++];)Qn(t)}function rr(e){e.addEventListener("DOMNodeRemovedFromDocument",function(){tr(e)})}function ar(){function t(e,t){var n=r[e];r[e]=function(e,r){return t.call(this,n,e,r)}}function n(t){var n=e.slice(this.getElementsByTagName("*"));a.call(this,t),nr(n)}if(!ar.execute){ar.execute=!0;var r=Node.prototype;t("removeChild",function(e,t,n){return e.call(this,t,n),1===t.nodeType&&tr(t),t}),t("replaceChild",function(e,t,n){return e.call(this,t,n),1===n.nodeType&&tr(n),t});var a,o=Element.prototype;try{var i=Object.getOwnPropertyDescriptor(o,"innerHTML"),a=i.set;i.set=n,Object.defineProperty(o,"innerHTML",i)}catch(s){if(!o||!o.__lookupSetter__)throw s;a=o.__lookupSetter__("innerHTML"),o.__defineSetter__("innerHTML",n)}t("appendChild",function(e,t){return e.call(this,t),1===t.nodeType&&11===this.nodeType&&tr(t),t}),t("insertBefore",function(e,t,n){return e.call(this,t,n),1===t.nodeType&&11===this.nodeType&&tr(t),t})}}function or(t){e.Array.ensure(rs,t),as||(as=setInterval(function(){for(var t,n=0;t=rs[n];)!1===Qn(t)?e.Array.removeAt(rs,n):n++;0==rs.length&&(clearInterval(as),as=0)},700))}function ir(e){if(Or.chrome&&Or.MutationEvent)rr(e);else try{ar(e)}catch(t){or(e)}}function sr(t,n){var r=n.props.is,a=n["component-vm:"+r],o="component-html:"+r,i=n[o],s=e.vdom(n,"toHTML");i!==s&&(n[o]=s,a.$fire("onViewChange",{type:"viewchange",target:t,vmodel:a,is:r}))}function cr(e){var t=!0;try{lr(e)}catch(n){t=!1}return t}function lr(e){e.children.forEach(function(e){if("#comment"===e.nodeName){if("unresolved component placeholder"===e.nodeValue)throw"unresolved"}else e.children&&lr(e)})}e.init=function(e){this[0]=this.element=e},e.fn=e.prototype=e.init.prototype,e.shadowCopy=function(e,t){for(var n in t)e[n]=t[n];return e};var ur={},dr=/([a-z\d])([A-Z]+)/g,fr=/[-_][^-_]/g,pr=/\d\.\d{4}/,vr=/[-.*+?^${}()|[\]\/\\]/g,mr=[].slice,hr=/[^, ]+/g,yr="object"==typeof console;e.shadowCopy(e,{noop:function(){},version:"2.1.17",rword:hr,inspect:{}.toString,ohasOwn:{}.hasOwnProperty,caches:{},vmodels:{},filters:{},components:{},directives:{},eventHooks:{},eventListeners:{},validators:{},scopes:{},effects:{},cssHooks:ur,parsers:{number:function(e){return""===e?"":parseFloat(e)||0},string:function(e){return null===e||void 0===e?"":e+""},"boolean":function(e){return""===e?e:"true"===e||"1"===e}},log:function(){yr&&e.config.debug&&Function.apply.call(console.log,console,arguments)},warn:function(){if(yr&&e.config.debug){var t=console.warn||console.log;Function.apply.call(t,console,arguments)}},error:function(e,t){throw(t||Error)(e)},oneObject:function(e,t){"string"==typeof e&&(e=e.match(hr)||[]);for(var n={},r=void 0!==t?t:1,a=0,o=e.length;o>a;a++)n[e[a]]=r;return n},isObject:function(e){return null!==e&&"object"==typeof e},range:function(e,t,n){n||(n=1),null==t&&(t=e||0,e=0);for(var r=-1,a=Math.max(0,Math.ceil((t-e)/n)),o=new Array(a);++r<a;)o[r]=e,e+=n;return o},hyphen:function(e){return e.replace(dr,"$1-$2").toLowerCase()},camelize:function(e){return!e||e.indexOf("-")<0&&e.indexOf("_")<0?e:e.replace(fr,function(e){return e.charAt(1).toUpperCase()})},slice:function(e,t,n){return mr.call(e,t,n)},css:function(t,n,r,a){if(t instanceof e&&(t=t[0]),1===t.nodeType){var o=e.camelize(n);if(n=e.cssName(o)||o,void 0===r||"boolean"==typeof r){a=ur[o+":get"]||ur["@:get"],"background"===n&&(n="backgroundColor");var i=a(t,n);return r===!0?parseFloat(i)||0:i}if(""===r)t.style[n]="";else{if(null==r||r!==r)return;isFinite(r)&&!e.cssNumber[o]&&(r+="px"),a=ur[o+":set"]||ur["@:set"],a(t,n,r)}}},directive:function(e,t){return t.parse=t.parse||n,this.directives[e]=t},makeHashCode:function(e){return e=e||"avalon",String(Math.random()+Math.random()).replace(pr,e)},escapeRegExp:function(e){return(e+"").replace(vr,"\\$&")},Array:{merge:function(e,t){e.push.apply(e,t)},ensure:function(e,t){return-1===e.indexOf(t)?e.push(t):void 0},removeAt:function(e,t){return!!e.splice(t,1).length},remove:function(t,n){var r=t.indexOf(n);return~r?e.Array.removeAt(t,r):!1}}});var gr=Object.prototype.hasOwnProperty;if(!r("司徒正美".trim)){var _r=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;String.prototype.trim=function(){return this.replace(_r,"")}}var br=!{toString:null}.propertyIsEnumerable("toString"),wr=function(){}.propertyIsEnumerable("prototype"),xr=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],$r=xr.length;r(Object.keys)||(Object.keys=function(e){var t=[],n=wr&&"function"==typeof e;if("string"==typeof e||e&&e.callee)for(var r=0;r<e.length;++r)t.push(String(r));else for(var a in e)n&&"prototype"===a||!gr.call(e,a)||t.push(String(a));if(br)for(var o=e.constructor,i=o&&o.prototype===e,s=0;$r>s;s++){var c=xr[s];i&&"constructor"===c||!gr.call(e,c)||t.push(c)}return t}),r(Array.isArray)||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),r(r.bind)||(Function.prototype.bind=function(e){if(arguments.length<2&&void 0===e)return this;var t=this,n=arguments;return function(){var r,a=[];for(r=1;r<n.length;r++)a.push(n[r]);for(r=0;r<arguments.length;r++)a.push(arguments[r]);return t.apply(e,a)}});var Cr=Array.prototype,Er=Cr.slice;try{Er.call(document.documentElement)}catch(Ar){Cr.slice=function(e,t){if(t="undefined"!=typeof t?t:this.length,Array.isArray(this))return Er.call(this,e,t);var n,r,a=[],o=this.length,i=e||0;i=i>=0?i:o+i;var s=t?t:o;if(0>t&&(s=o+t),r=s-i,r>0)if(a=new Array(r),this.charAt)for(n=0;r>n;n++)a[n]=this.charAt(i+n);else for(n=0;r>n;n++)a[n]=this[i+n];return a}}if(!r(Cr.map)){var kr={indexOf:function(e,t){var n=this.length,r=~~t;for(0>r&&(r+=n);n>r;r++)if(this[r]===e)return r;return-1},lastIndexOf:function(e,t){var n=this.length,r=null==t?n-1:t;for(0>r&&(r=Math.max(0,n+r));r>=0;r--)if(this[r]===e)return r;return-1},forEach:a("","_",""),filter:a("r=[],j=0,","if(_)r[j++]=this[i]","return r"),map:a("r=[],","r[i]=_","return r"),some:a("","if(_)return true","return false"),every:a("","if(!_)return false","return true")};for(var Tr in kr)Cr[Tr]=kr[Tr]}var Or=Function(" return this")()||this,Nr={window:Or,document:{createElement:Object,createElementNS:Object,contains:Boolean},root:{outerHTML:"x"},msie:0/0,browser:!1,modern:!0,avalonDiv:{},avalonFragment:null};if(Or.avalon=e,Or.location&&Or.navigator&&Or.window){var Mr=Or.document;Nr.inBrowser=!0,Nr.document=Mr,Nr.root=Mr.documentElement,Nr.avalonDiv=Mr.createElement("div"),Nr.avalonFragment=Mr.createDocumentFragment(),Or.VBArray?(Nr.msie=Mr.documentMode||(Or.XMLHttpRequest?7:6),Nr.modern=Nr.msie>8):Nr.modern=!0}e.shadowCopy(e,Nr),e.quote="undefined"!=typeof JSON?JSON.stringify:new function(){var e={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},t="000000",n=function(e,n){return(t+(n||0)).slice(-e)},r="\\u00",a=function(t){var a=t.charCodeAt(0),o=e[a];return o?o:r+n(2,a.toString(16))},o=/[\x00-\x1f\x22\x5c]/g;return function(e){return o.lastIndex=0,'"'+(o.test(e)?String(e).replace(o,a):e)+'"'}};var jr=e.inspect,Sr={};"Boolean Number String Function Array Date RegExp Object Error".replace(e.rword,function(e){Sr["[object "+e+"]"]=e.toLowerCase()}),e.type=function(e){return null==e?String(e):"object"==typeof e||"function"==typeof e?Sr[jr.call(e)]||"object":typeof e};var Dr=/^\s*\bfunction\b/;e.isFunction="object"==typeof alert?function(e){try{return Dr.test(e+"")}catch(t){return!1}}:function(e){return"[object Function]"===jr.call(e)};var Lr=/^\[object (?:Window|DOMWindow|global)\]$/;e.isWindow=i(e.window)?i:o;var Vr,Fr;for(Vr in e({}))break;var gr=e.ohasOwn;Fr="0"!==Vr,e.isPlainObject=/\[native code\]/.test(Object.getPrototypeOf)?c:s,e.mix=e.fn.mix=function(){var t,n,r,a,o,i,s=arguments[0]||{},c=1,l=arguments.length,u=!1;for("boolean"==typeof s&&(u=s,s=arguments[1]||{},c++),"object"==typeof s||e.isFunction(s)||(s={}),c===l&&(s=this,c--);l>c;c++)if(null!=(t=arguments[c]))for(n in t){try{r=s[n],a=t[n]}catch(d){continue}s!==a&&(u&&a&&(e.isPlainObject(a)||(o=Array.isArray(a)))?(o?(o=!1,i=r&&Array.isArray(r)?r:[]):i=r&&e.isPlainObject(r)?r:{},s[n]=e.mix(u,i,a)):void 0!==a&&(s[n]=a))}return s};var Hr=/(Array|List|Collection|Map|Arguments)\]$/;e.each=function(e,t){if(e){var n=0;if(l(e))for(var r=e.length;r>n&&t(n,e[n])!==!1;n++);else for(n in e)if(e.hasOwnProperty(n)&&t(n,e[n])===!1)break}};var Pr=u.prototype;Pr.put=function(e,t){var n={key:e,value:t};return this._keymap[e]=n,this.tail?(this.tail.newer=n,n.older=this.tail):this.head=n,this.tail=n,this.size===this.limit?this.shift():this.size++,t},Pr.shift=function(){var e=this.head;e&&(this.head=this.head.newer,this.head.older=e.newer=e.older=this._keymap[e.key]=void 0,delete this._keymap[e.key],this.size--)},Pr.get=function(e){var t=this._keymap[e];if(void 0!==t)return t===this.tail?t.value:(t.newer&&(t===this.head&&(this.head=t.newer),t.newer.older=t.older),t.older&&(t.older.newer=t.newer),t.newer=void 0,t.older=this.tail,this.tail&&(this.tail.newer=t),this.tail=t,t.value)};var Ir=/&[a-z0-9#]{2,10};/,Br=e.avalonDiv;e.shadowCopy(e,{evaluatorPool:new u(888),_decode:function(e){return Ir.test(e)?(Br.innerHTML=e,Br.innerText||Br.textContent):e}});var zr=e.directives,Rr=1,qr=e.quote,Ur=e.window,Yr=e.document,Wr=e.root,Zr=e.modern,Xr=e.eventHooks;e.config=p;var Kr={interpolate:function(t){var n=t[0],r=t[1];if(n===r)throw new SyntaxError("openTag!==closeTag");var a=n+"test"+r,o=e.avalonDiv;if(o.innerHTML=a,o.innerHTML!==a&&o.innerHTML.indexOf("&lt;")>-1)throw new SyntaxError("此定界符不合法");o.innerHTML="",p.openTag=n,p.closeTag=r;var i=e.escapeRegExp(n),s=e.escapeRegExp(r);p.rexpr=new RegExp(i+"([\\s\\S]*)"+s)}};p.plugins=Kr,e.config({interpolate:["{{","}}"],debug:!0});var Gr=/<script[^>]*>([\S\s]*?)<\/script\s*>/gim,Jr=/\s+(on[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,Qr=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/gi,ea={a:/\b(href)\=("javascript[^"]*"|'javascript[^']*')/gi,img:/\b(src)\=("javascript[^"]*"|'javascript[^']*')/gi,form:/\b(action)\=("javascript[^"]*"|'javascript[^']*')/gi},ta={yyyy:g("FullYear",4),yy:g("FullYear",2,0,!0),y:g("FullYear",1),MMMM:_("Month"),MMM:_("Month",!0),MM:g("Month",2,1),M:g("Month",1,1),dd:g("Date",2),d:g("Date",1),HH:g("Hours",2),H:g("Hours",1),hh:g("Hours",2,-12),h:g("Hours",1,-12),mm:g("Minutes",2),m:g("Minutes",1),ss:g("Seconds",2),s:g("Seconds",1),sss:g("Milliseconds",3),EEEE:_("Day"),EEE:_("Day",!0),a:w,Z:b},na=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,ra=/^\/Date\((\d+)\)\/$/,aa={AMPMS:{0:"上午",1:"下午"},DAY:{0:"星期日",1:"星期一",2:"星期二",3:"星期三",4:"星期四",5:"星期五",6:"星期六"},MONTH:{0:"1月",1:"2月",2:"3月",3:"4月",4:"5月",5:"6月",6:"7月",7:"8月",8:"9月",9:"10月",10:"11月",11:"12月"},SHORTDAY:{0:"周日",1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六"},fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"yyyy-M-d H:mm:ss",mediumDate:"yyyy-M-d",mediumTime:"H:mm:ss","short":"yy-M-d ah:mm",shortDate:"yy-M-d",shortTime:"ah:mm"};aa.SHORTMONTH=aa.MONTH,x.locate=aa,Number.isNaN=Number.isNaN||function(e){return e!==e};var oa={orderBy:$,filterBy:C,selectBy:E,limitBy:A},ia={stop:function(e){return e.stopPropagation(),e},prevent:function(e){return e.preventDefault(),e}},sa={esc:27,tab:9,enter:13,space:32,del:46,up:38,left:37,right:39,down:40};for(var ca in sa)!function(e,t){ia[e]=function(e){return e.which!==t&&(e.$return=!0),e}}(ca,sa[ca]);var la=e.filters;e.escapeHtml=O,e.__format__=function(e){var t=la[e];return t?t:N},e.mix(la,{uppercase:function(e){return String(e).toUpperCase()},lowercase:function(e){return String(e).toLowerCase()},truncate:function(e,t,n){return e?(e=String(e),isNaN(t)&&(t=30),n="string"==typeof n?n:"...",e.length>t?e.slice(0,t-n.length)+n:e):""},camelize:e.camelize,date:x,escape:O,sanitize:m,number:v,currency:function(e,t,n){return(t||"¥")+v(e,isFinite(n)?n:2)}},oa,ia),M.prototype={constructor:M,toDOM:function(){if(this.dom)return this.dom;var t=e._decode(this.nodeValue);return this.dom=document.createTextNode(t)},toHTML:function(){return this.nodeValue}},j.prototype={constructor:j,toDOM:function(){return this.dom=document.createComment(this.nodeValue)},toHTML:function(){return"<!--"+this.nodeValue+"-->"}};var ua={"class":function(e,t){e.className=t},style:function(e,t){e.style.cssText=t},type:function(e,t){try{e.type=t}catch(n){}},"for":function(e,t){e.htmlFor=t}};S.prototype={constructor:S,toDOM:function(){if(this.dom)return this.dom;var t,n=this.nodeName;t=e.modern&&da[n]?L(n):e.modern||!pa[n]&&!fa.test(n)?document.createElement(n):V(n);var r=this.props||{},a=r["ms-important"]||r["ms-controller"]||this.wid;if(a){var o=e.scopes[a],i=o&&o.vmodel&&o.vmodel.$element;if(i){var s=i.vtree[0];return s.children&&(this.children=s.children),i}}for(var c in r){var l=r[c];D(l)&&(ua[c]&&e.msie<8?ua[c](t,l):t.setAttribute(c,l+""))}var u=this.children||[],d=u[0]?u[0].nodeValue:"";switch(this.nodeName){case"script":t.type="noexec",t.text=d,t.type=r.type||"";break;case"style":"styleSheet"in t?(t.setAttribute("type","text/css"),t.styleSheet.cssText=d):t.innerHTML=d;break;case"xmp":case"noscript":t.textContent=d;break;case"template":t.innerHTML=d;break;default:this.isVoidTag||this.children.forEach(function(n){n&&t.appendChild(e.vdom(n,"toDOM"))})}return this.dom=t},toHTML:function(){var t=[],n=this.props||{};for(var r in n){var a=n[r];D(a)&&t.push(r+"="+e.quote(n[r]+""))}t=t.length?" "+t.join(" "):"";var o="<"+this.nodeName+t;return this.isVoidTag?o+"/>":(o+=">",this.children&&(o+=this.children.map(function(t){return t?e.vdom(t,"toHTML"):""}).join("")),o+"</"+this.nodeName+">")}};var da=e.oneObject("circle,defs,ellipse,image,line,path,polygon,polyline,rect,symbol,text,use,g,svg"),fa=/^\w+\:\w+/,pa=e.oneObject("shape,line,polyline,rect,roundrect,oval,arc,curve,background,image,shapetype,group,fill,stroke,shadow, extrusion, textbox, imagedata, textpath");F.prototype={constructor:F,toDOM:function(){if(this.dom)return this.dom;for(var t,n=document.createDocumentFragment(),r=0;t=this.children[r++];)n.appendChild(e.vdom(t,"toDOM"));return this.split=n.lastChild,this.dom=n},toHTML:function(){return this.children.map(function(t){return e.vdom(t,"toHTML")}).join("")}},e.vdom=e.vdomAdaptor=function(e,t){if(!e)return"toHTML"===t?"":document.createDocumentFragment();switch(e.nodeName){case"#text":return M.prototype[t].call(e);case"#comment":return j.prototype[t].call(e);case"#document-fragment":return F.prototype[t].call(e);case void 0:return new F(e)[t]();default:return S.prototype[t].call(e)}};var va={VText:M,VComment:j,VElement:S,VFragment:F};e.shadowCopy(e.vdom,va),e.domize=function(t){return e.vdom(t,"toDOM")};var ma=/radio|checkbox/;e.cloneNode=function(e){return e.cloneNode(!0)},e.contains=B,e.browser&&(e.msie<10&&(e.cloneNode=I),document.contains||(document.contains=function(e){return B(document,e)}),Or.Node&&!document.createTextNode("x").contains&&(Node.prototype.contains=function(e){return!!(16&this.compareDocumentPosition(e))}),Or.HTMLElement&&!e.root.outerHTML&&HTMLElement.prototype.__defineGetter__("outerHTML",function(){var e=document.createElement("div");return e.appendChild(this),e.innerHTML}));var ha=/\S+/g,ya={_toString:function(){var e=this.node,t=e.className,n="string"==typeof t?t:t.baseVal,r=n.match(ha);return r?r.join(" "):""},_contains:function(e){return(" "+this+" ").indexOf(" "+e+" ")>-1},_add:function(e){this.contains(e)||this._set(this+" "+e)},_remove:function(e){this._set((" "+this+" ").replace(" "+e+" "," "))},__set:function(e){e=e.trim();var t=this.node;"object"==typeof t.className?t.setAttribute("class",e):t.className=e}};"add,remove".replace(e.rword,function(t){e.fn[t+"Class"]=function(e){var n=this[0]||{};return e&&"string"==typeof e&&1===n.nodeType&&e.replace(ha,function(e){z(n)[t](e)}),this}}),e.shadowCopy(e.fn,{hasClass:function(e){var t=this[0]||{};return 1===t.nodeType&&z(t).contains(e)},toggleClass:function(e,t){var n="boolean"==typeof t,r=this;return String(e).replace(ha,function(e){var a=n?t:!r.hasClass(e);r[a?"addClass":"removeClass"](e)}),this}});var ga={"accept-charset":"acceptCharset","char":"ch",charoff:"chOff","class":"className","for":"htmlFor","http-equiv":"httpEquiv"},_a=["autofocus,autoplay,async,allowTransparency,checked,controls","declare,disabled,defer,defaultChecked,defaultSelected,","isMap,loop,multiple,noHref,noResize,noShade","open,readOnly,selected"].join(",");_a.replace(/\w+/g,function(e){ga[e.toLowerCase()]=e});var ba=["accessKey,bgColor,cellPadding,cellSpacing,codeBase,codeType,colSpan","dateTime,defaultValue,contentEditable,frameBorder,longDesc,maxLength,marginWidth,marginHeight,rowSpan,tabIndex,useMap,vSpace,valueType,vAlign"].join(",");ba.replace(/\w+/g,function(e){ga[e.toLowerCase()]=e});var wa=/^\[object SVG\w*Element\]$/,xa=/&amp;/g,$a=/^[\],:{}\s]*$/,Ca=/(?:^|:|,)(?:\s*\[)+/g,Ea=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,Aa=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g;e.parseJSON="object"==typeof JSON?JSON.parse:function(t){if("string"==typeof t){if(t=t.trim(),t&&$a.test(t.replace(Ea,"@").replace(Aa,"]").replace(Ca,"")))return new Function("return "+t)();e.error("Invalid JSON: "+t)}return t},e.fn.attr=function(e,t){return 2===arguments.length?(this[0].setAttribute(e,t),this):this[0].getAttribute(e)};var ka=e.cssHooks,Ta={"float":"cssFloat"};e.cssNumber=e.oneObject("animationIterationCount,columnCount,order,flex,flexGrow,flexShrink,fillOpacity,fontWeight,lineHeight,opacity,orphans,widows,zIndex,zoom");var Oa=["","-webkit-","-o-","-moz-","-ms-"];e.cssName=function(t,n,r){if(Ta[t])return Ta[t];n=n||e.root.style||{};for(var a=0,o=Oa.length;o>a;a++)if(r=e.camelize(Oa[a]+t),r in n)return Ta[t]=r;return null},e.fn.css=function(t,n){if(e.isPlainObject(t))for(var r in t)e.css(this,r,t[r]);else var a=e.css(this,t,n);return void 0!==a?a:this},e.fn.position=function(){var t,n,r=this[0],a={top:0,left:0};return r?("fixed"===this.css("position")?n=r.getBoundingClientRect():(t=this.offsetParent(),n=this.offset(),"HTML"!==t[0].tagName&&(a=t.offset()),a.top+=e.css(t[0],"borderTopWidth",!0),a.left+=e.css(t[0],"borderLeftWidth",!0),a.top-=t.scrollTop(),a.left-=t.scrollLeft()),{top:n.top-a.top-e.css(r,"marginTop",!0),left:n.left-a.left-e.css(r,"marginLeft",!0)}):a},e.fn.offsetParent=function(){for(var t=this[0].offsetParent;t&&"static"===e.css(t,"position");)t=t.offsetParent;return e(t||e.root)},ka["@:set"]=function(e,t,n){try{e.style[t]=n}catch(r){}},ka["@:get"]=function(e,t){if(!e||!e.style)throw new Error("getComputedStyle要求传入一个节点 "+e);var n,r=getComputedStyle(e,null);return r&&(n="filter"===t?r.getPropertyValue(t):r[t],""===n&&(n=e.style[t])),n},ka["opacity:get"]=function(e){var t=ka["@:get"](e,"opacity");return""===t?"1":t},"top,left".replace(e.rword,function(t){ka[t+":get"]=function(n){var r=ka["@:get"](n,t);return/px$/.test(r)?r:e(n).position()[t]+"px"}});var Na={position:"absolute",visibility:"hidden",display:"block"},Ma=/^(none|table(?!-c[ea]).+)/;if(e.each({Width:"width",Height:"height"},function(t,n){var r="client"+t,a="scroll"+t,o="offset"+t;ka[n+":get"]=function(n,r,a){var i=-4;"number"==typeof a&&(i=a),r="Width"===t?["Left","Right"]:["Top","Bottom"];var s=n[o];return 2===i?s+e.css(n,"margin"+r[0],!0)+e.css(n,"margin"+r[1],!0):(0>i&&(s=s-e.css(n,"border"+r[0]+"Width",!0)-e.css(n,"border"+r[1]+"Width",!0)),-4===i&&(s=s-e.css(n,"padding"+r[0],!0)-e.css(n,"padding"+r[1],!0)),s)},ka[n+"&get"]=function(e){var t=[];U(e,t);for(var r,a=ka[n+":get"](e),o=0;r=t[o++];){e=r.node;for(var i in r)"string"==typeof r[i]&&(e.style[i]=r[i])}return a},e.fn[n]=function(e){var i=this[0];if(0===arguments.length){if(i.setTimeout)return i["inner"+t]||i.document.documentElement[r]||i.document.body[r];if(9===i.nodeType){var s=i.documentElement;return Math.max(i.body[a],s[a],i.body[o],s[o],s[r])}return ka[n+"&get"](i)}return this.css(n,e)},e.fn["inner"+t]=function(){return ka[n+":get"](this[0],void 0,-2)},e.fn["outer"+t]=function(e){return ka[n+":get"](this[0],void 0,e===!0?2:0)}}),e.msie<9){Ta["float"]="styleFloat";var ja=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,Sa=/^(top|right|bottom|left)$/,Da=/alpha\([^)]*\)/i,La=8===e.msie,Va={thin:La?"1px":"2px",medium:La?"3px":"4px",thick:La?"5px":"6px"};ka["@:get"]=function(e,t){var n=e.currentStyle,r=n[t];if(ja.test(r)&&!Sa.test(r)){var a=e.style,o=a.left,i=e.runtimeStyle.left;e.runtimeStyle.left=n.left,a.left="fontSize"===t?"1em":r||0,r=a.pixelLeft+"px",a.left=o,e.runtimeStyle.left=i}return"medium"===r&&(t=t.replace("Width","Style"),"none"===n[t]&&(r="0px")),""===r?"auto":Va[r]||r},ka["opacity:set"]=function(e,t,n){var r=e.style,a=isFinite(n)&&1>=n?"alpha(opacity="+100*n+")":"",o=r.filter||"";r.zoom=1,r.filter=(Da.test(o)?o.replace(Da,a):o+" "+a).trim(),r.filter||r.removeAttribute("filter")},ka["opacity:get"]=function(e){for(var t,n=/(opacity|\d(\d|\.)*)/g,r=e.style.filter.match(n)||[],a=!1,o=0;t=r[o++];)if("opacity"===t)a=!0;else if(a)return t/100+"";return"1"}}e.fn.offset=function(){var t=this[0],n={left:0,top:0};if(!t||!t.tagName||!t.ownerDocument)return n;var r=t.ownerDocument,a=r.body,o=r.documentElement,i=r.defaultView||r.parentWindow;if(!e.contains(o,t))return n;t.getBoundingClientRect&&(n=t.getBoundingClientRect());var s=o.clientTop||a.clientTop,c=o.clientLeft||a.clientLeft,l=Math.max(i.pageYOffset||0,o.scrollTop,a.scrollTop),u=Math.max(i.pageXOffset||0,o.scrollLeft,a.scrollLeft);return{top:n.top+l-s,left:n.left+u-c}},e.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,n){e.fn[t]=function(r){var a=this[0]||{},o=Y(a),i="scrollTop"===t;return arguments.length?void(o?o.scrollTo(i?e(o).scrollLeft():r,i?r:e(o).scrollTop()):a[t]=r):o?n in o?o[n]:root[t]:a[t]}});var Fa=/^<option(?:\s+\w+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s>]+))?)*\s+value[\s=]/i,Ha={"option:get":e.msie?function(e){return Fa.test(e.outerHTML)?e.value:e.text.trim()}:function(e){return e.value},"select:get":function(e,t){for(var n,r=e.options,a=e.selectedIndex,o=Ha["option:get"],i="select-one"===e.type||0>a,s=i?null:[],c=i?a+1:r.length,l=0>a?c:i?a:0;c>l;l++)if(n=r[l],!(!n.selected&&l!==a||n.disabled||n.parentNode.disabled&&"OPTGROUP"===n.parentNode.tagName)){if(t=o(n),i)return t;s.push(t)}return s},"select:set":function(e,t,n){t=[].concat(t);for(var r,a=Ha["option:get"],o=0;r=e.options[o++];)(r.selected=t.indexOf(a(r))>-1)&&(n=!0);n||(e.selectedIndex=-1)}};e.fn.val=function(e){var t=this[0];if(t&&1===t.nodeType){var n=0===arguments.length,r=n?":get":":set",a=Ha[W(t)+r];if(a)var o=a(t,e);else{if(n)return(t.value||"").replace(/\r/g,"");t.value=e}}return n?o:this};var Pa=/<|&#?\w+;/,Ia=new u(128),Ba=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi;e.parseHTML=function(t){var n=e.avalonFragment.cloneNode(!1);if("string"!=typeof t)return n;if(!Pa.test(t))return document.createTextNode(t);t=t.replace(Ba,"<$1></$2>").trim();var r=Ia.get(t);if(r)return e.cloneNode(r);for(var a,o=e.lexer(t),i=0;a=o[i++];)n.appendChild(e.vdom(a,"toDOM"));return t.length<1024&&Ia.put(t,n),n},e.innerHTML=function(e,t){var n=this.parseHTML(t);this.clearHTML(e).appendChild(n)},e.unescapeHTML=function(e){return String(e).replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")},e.clearHTML=function(e){for(e.textContent="";e.lastChild;)e.removeChild(e.lastChild);return e};var za={click:!0,dblclick:!0,keydown:!0,keypress:!0,keyup:!0,mousedown:!0,mousemove:!0,mouseup:!0,mouseover:!0,mouseout:!0,wheel:!0,mousewheel:!0,input:!0,change:!0,beforeinput:!0,compositionstart:!0,compositionupdate:!0,compositionend:!0,select:!0,cut:!0,copy:!0,paste:!0,beforecut:!0,beforecopy:!0,beforepaste:!0,focusin:!0,focusout:!0,DOMFocusIn:!0,DOMFocusOut:!0,DOMActivate:!0,dragend:!0,datasetchanged:!0},Ra=e.modern&&Yr.ontouchstart;e.fn.bind=function(t,n,r){return this[0]?e.bind(this[0],t,n,r):void 0},e.fn.unbind=function(t,n,r){return this[0]&&e.unbind(this[0],t,n,r),this},e.bind=function(t,n,r){if(1===t.nodeType){var a=t.getAttribute("avalon-events")||"",o=f(r),i=Xr[n];"click"===n&&Ra&&t.addEventListener("click",e.noop),i&&(n=i.type||n,i.fix&&(r=i.fix(t,r),r.uuid=o));var s=n+":"+o;e.eventListeners[r.uuid]=r,-1===a.indexOf(n+":")&&(za[n]||e.modern&&Wa[n]?K(n):e._nativeBind(t,n,X));var c=a.split(",");""===c[0]&&c.shift(),-1===c.indexOf(s)&&(c.push(s),t.setAttribute("avalon-events",c.join(",")))}else e._nativeBind(t,n,r);return r},e.unbind=function(t,n,r){if(1===t.nodeType){var a=t.getAttribute("avalon-events")||"";switch(arguments.length){case 1:e._nativeUnBind(t,n,X),t.removeAttribute("avalon-events");break;case 2:a=a.split(",").filter(function(e){return-1===e.indexOf(n+":")}).join(","),t.setAttribute("avalon-events",a);break;default:var o=n+":"+r.uuid;a=a.split(",").filter(function(e){return e!==o}).join(","),t.setAttribute("avalon-events",a),delete e.eventListeners[r.uuid]}}else e._nativeUnBind(t,n,r)};var qa={},Ua=/^e/,Ya=!1,Wa={focus:!0,blur:!0},Za=/^[A-Z_]+$/;if(G.prototype={fixEvent:function(){},preventDefault:function(){var e=this.originalEvent||{};e.returnValue=this.returnValue=!1,e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent||{};e.cancelBubble=this.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){Ya=!0,this.stopPropagation()},toString:function(){return"[object Event]"}},"onmouseenter"in Wr||e.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){Xr[e]={type:t,fix:function(t,n){return function(r){var a=r.relatedTarget;return a&&(a===t||16&t.compareDocumentPosition(a))?void 0:(delete r.type,r.type=e,n.apply(this,arguments))}}}}),e.each({AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"},function(e,t){Ur[e]&&!Xr.animationend&&(Xr.animationend={type:t})}),void 0===Yr.onmousewheel){var Xa=void 0!==Yr.onwheel?"wheel":"DOMMouseScroll",Ka="wheel"===Xa?"deltaY":"detail";Xr.mousewheel={type:Xa,fix:function(e,t){return function(n){var r=n[Ka]>0?-120:120;return n.wheelDelta=~~e._ms_wheel_+r,e._ms_wheel_=n.wheelDeltaY=n.wheelDelta,n.wheelDeltaX=0,Object.defineProperty&&Object.defineProperty(n,"type",{value:"mousewheel"}),t.apply(this,arguments)}}}}Zr||(delete za.change,delete za.select),e._nativeBind=Zr?function(e,t,n,r){e.addEventListener(t,n,r)}:function(e,t,n){e.attachEvent("on"+t,n)},e._nativeUnBind=Zr?function(e,t,n){e.removeEventListener(t,n)}:function(e,t,n){e.detachEvent("on"+t,n)},e.fireDom=function(t,n,r){if(Yr.createEvent){var a=Yr.createEvent("Events");a.initEvent(n,!0,!0,r),e.shadowCopy(a,r),t.dispatchEvent(a)}else Wr.contains(t)&&(a=Yr.createEventObject(),e.shadowCopy(a,r),t.fireEvent("on"+n,a))};var Ga=/^(?:mouse|contextmenu|drag)|click/;G.prototype.fixEvent=function(){var e=this;if(null==this.which&&0===e.type.indexOf("key"))this.which=null!=e.charCode?e.charCode:e.keyCode;else if(Ga.test(e.type)&&!("pageX"in this)){var t=e.target.ownerDocument||Yr,n="BackCompat"===t.compatMode?t.body:t.documentElement;this.pageX=e.clientX+(n.scrollLeft>>0)-(n.clientLeft>>0),this.pageY=e.clientY+(n.scrollTop>>0)-(n.clientTop>>0),this.wheelDeltaY=this.wheelDelta,this.wheelDeltaX=0}},"oninput"in Yr.createElement("input")||(Xr.input={type:"propertychange",fix:function(e,t){return function(e){return"value"===e.propertyName?(e.type="input",t.apply(this,arguments)):void 0}}});var Ja={area:1,base:1,basefont:1,bgsound:1,br:1,col:1,command:1,embed:1,frame:1,hr:1,img:1,input:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1},Qa=/input|textarea|select/i,eo=/^\:/;e.scan=function(t){return t&&t.nodeType?void nt([t]):void e.warn("[avalon.scan] first argument must be element , documentFragment, or document")
},e._hydrate=J;var to,no=!0,ro=[],ao=function(t){for(to=!0;t=ro.shift();)t(e)};e.ready=function(t){to?t(e):ro.push(t)},e.ready(function(){e.scan(Yr.body)}),new function(){function t(){try{Wr.doScroll("left"),ao()}catch(e){setTimeout(t)}}if(e.inBrowser){if("complete"===Yr.readyState)setTimeout(ao);else if(Yr.addEventListener)Yr.addEventListener("DOMContentLoaded",ao);else if(Yr.attachEvent){Yr.attachEvent("onreadystatechange",function(){"complete"===Yr.readyState&&ao()});try{var n=null===Ur.frameElement}catch(r){}Wr.doScroll&&n&&Ur.external&&t()}e.bind(Ur,"load",ao)}};var oo={};ot.adjust=at;var io=e.oneObject("$id,$render,$track,$element,$watch,$fire,$events,$skipArray,$accessors,$hashcode,$run,$wait,__proxy__,__data__,__const__"),so={set:function(e,t){if(e>>>0===e&&this[e]!==t){if(e>this.length)throw Error(e+"set方法的第一个参数不能大于原数组长度");this.splice(e,1,t)}},contains:function(e){return-1!==this.indexOf(e)},ensure:function(e){return this.contains(e)||this.push(e),this},pushArray:function(e){return this.push.apply(this,e)},remove:function(e){return this.removeAt(this.indexOf(e))},removeAt:function(e){return e>>>0===e?this.splice(e,1):[]},clear:function(){return this.removeAll(),this}},co=Array.prototype,lo=co.splice;so.removeAll=function(e){var t=this.length;if(Array.isArray(e))for(var n=this.length-1;n>=0;n--)-1!==e.indexOf(this[n])&&lo.call(this,n,1);else if("function"==typeof e)for(n=this.length-1;n>=0;n--){var r=this[n];e(r,n)&&lo.call(this,n,1)}else lo.call(this,0,this.length);oo.toModel(this),lt(this,t),this.notify()};var uo=["push","pop","shift","unshift","splice"];uo.forEach(function(e){var t=co[e];so[e]=function(n,r){var a=[],o=this.length;if("splice"===e&&Object(this[0])===this[0])for(var i=this.slice(n,r),s=co.slice.call(arguments,2),a=[n,r],c=0,l=s.length;l>c;c++){var u=i[c];a[c+2]=oo.modelAdaptor(s[c],u,u&&u.$events||{},{id:this.$id+".*",master:!0})}else for(var d=0,f=arguments.length;f>d;d++)a[d]=oo.modelAdaptor(arguments[d],0,{},{id:this.$id+".*",master:!0});var p=t.apply(this,a);return oo.toModel(this),lt(this,o),this.notify(),p}}),"sort,reverse".replace(/\w+/g,function(e){so[e]=function(){return co[e].apply(this,arguments),oo.toModel(this),this.notify(),this}});var fo=/function|window|date|regexp|element/i;oo.isSkip=ut,oo.modelAdaptor=dt,oo.makeAccessor=ft,e.define=function(t){var n=t.$id;if(n||e.warn("vm.$id must be specified"),e.vmodels[n])throw Error("error:["+n+"] had defined!");var r=oo.masterFactory(t,{},{pathname:"",id:n,master:!0});return e.vmodels[n]=r},oo.arrayFactory=vt;var po=/([^.]+)\.(.+)/;oo.$$skipArray=io;var vo=!0;try{Object.defineProperty({},"_",{value:"x"})}catch(Ar){vo=!1}oo.canHideProperty=vo,oo.toJson=gt,oo.toModel=function(t){e.modern||(t.$model=gt(t))},oo.hideProperty=_t;var mo={get:function(){return gt(this)},set:e.noop,enumerable:!1,configurable:!0};oo.modelAccessor=mo,oo.initViewModel=bt;var ho,yo=Object.defineProperties,go=new Date-0;if(!vo&&("__defineGetter__"in e&&(ho=function(e,t,n){return"value"in n&&(e[t]=n.value),"get"in n&&e.__defineGetter__(t,n.get),"set"in n&&e.__defineSetter__(t,n.set),e},yo=function(e,t){for(var n in t)t.hasOwnProperty(n)&&ho(e,n,t[n]);return e}),e.msie<9)){var _o={};Or.execScript(["Function parseVB(code)","	ExecuteGlobal(code)","End Function"].join("\n"),"VBScript");var bo=function(e,t,n,r){var a=t[n];return 4!==arguments.length?a.get.call(e):void a.set.call(e,r)};yo=function(t,n,r){var a=[];a.push("\r\n	Private [__data__], [__proxy__]","	Public Default Function [__const__](d"+go+", p"+go+")","		Set [__data__] = d"+go+": set [__proxy__] = p"+go,"		Set [__const__] = Me","	End Function");var o={__proxy__:!0,__data__:!0,__const__:!0};for(t in n)o[t]||io[t]||(o[t]=!0,a.push("	Public Property Let ["+t+"](val"+go+")",'		Call [__proxy__](Me,[__data__], "'+t+'", val'+go+")","	End Property","	Public Property Set ["+t+"](val"+go+")",'		Call [__proxy__](Me,[__data__], "'+t+'", val'+go+")","	End Property","	Public Property Get ["+t+"]","	On Error Resume Next","		Set["+t+'] = [__proxy__](Me,[__data__],"'+t+'")',"	If Err.Number <> 0 Then","		["+t+'] = [__proxy__](Me,[__data__],"'+t+'")',"	End If","	On Error Goto 0","	End Property"));for(t in r)o[t]||io[t]||(o[t]=!0,a.push("	Public ["+t+"]"));for(t in io)o[t]||a.push("	Public ["+t+"]");a.push("	Public [hasOwnProperty]"),a.push("End Class");var i=a.join("\r\n"),s=_o[i];s||(s=e.makeHashCode("VBClass"),Or.parseVB("Class "+s+i),Or.parseVB(["Function "+s+"Factory(a, b)","	Dim o","	Set o = (New "+s+")(a, b)","	Set "+s+"Factory = o","End Function"].join("\r\n")),_o[i]=s);var c=Or[s+"Factory"](n,bo);return c}}oo.createViewModel=yo;var wo=oo.isSkip,xo=oo.$$skipArray;oo.canHideProperty&&(delete xo.$accessors,delete xo.__data__,delete xo.__proxy__,delete xo.__const__);var $o=oo.makeAccessor,Co=oo.modelAccessor,Eo=oo.createViewModel,Ao=oo.initViewModel,ko=e.makeHashCode;oo.masterFactory=Ct;var To={};oo.slaveFactory=Et,e.mediatorFactory=At,e.directive("important",{priority:1,parse:function(e,t,n){var r=qr(n.expr);e.local="{}",e.vmodel="__vmodel__",e[n.name]=1,t.$prepend=["(function(__top__){","var __i = avalon.scopes["+r+"]","var ok = !__i || __i.vmodel === __top__","if( !ok ){",'vnodes.push({skipContent:true,nodeName:"'+e.nodeName+'"})','avalon.log("不进入"+'+r+");return }","var __vmodel__ = avalon.vmodels["+r+"];"].join("\n")+"\n",t.$append="\n})(__vmodel__);"},diff:function(e,t,n){t.dynamic[n]||(t.local=e.local,t.vmodel=e.vmodel,kt(t,this.update))},update:function(t,n,r){e.directives.controller.update(t,n,r,"important")}});var Oo={};e.mediatorFactoryCache=function(t,n){var r=e.vmodels[n];if(r&&t&&r!==t){var a=t.$hashcode,o=r.$hashcode,i=a+o;if(Oo[i])return Oo[i];var s=e.mediatorFactory(t,r);return Oo[i]=s}return t},e.directive("controller",{priority:2,parse:function(e,t,n){var r=qr(n.expr);e.local="__local__",e.vmodel="__vmodel__",e[n.name]=1,t.$prepend="(function(__top__){\nvar __vmodel__ = avalon.mediatorFactoryCache(__top__,"+r+")\n",t.$append="\n})(__vmodel__);"},diff:function(e,t,n){t.dynamic[n]||(t.local=e.local,t.vmodel=e.vmodel,kt(t,this.update))},update:function(t,n,r,a){var o=n.vmodel,i=n.local,s=a?"ms-important":"ms-controller";n.dynamic[s]=1;var c=n.props[s],l=e.scopes[c];if(!l){var u=e.vmodels[c];if(o.$element&&o.$element.vtree[0]===n)var d=o.$render;else d=e.render([n],i);o.$render=d,o.$element=t,t.vtree=[n],u!==o&&(u.$render=u.$render||d,u.$element=u.$element||t);var f=a?o:u,l=e.scopes[c]={vmodel:o,local:i};kt(n,function(){e(t).removeClass("ms-controller"),t.setAttribute("wid",c),e._disposeComponent&&e._disposeComponent(t);var n=f.$events.onReady;n&&(f.$fire("onReady"),delete f.$events.onReady),l.isMount=!0},"afterChange")}}});var No=e.directive("css",{diff:function(t,n,r){var a=t[r],o=n[r];if(Object(a)===a){if(a=a.$model||a,Array.isArray(a)){var i={};a.forEach(function(t){t&&e.shadowCopy(i,t)}),a=i}var s=!1;if(n.dynamic[r]&&o){var c={};for(var l in a)a[l]!==o[l]&&(s=!0),c[l]=a[l];for(var l in o)l in c||(s=!0,c[l]="");n[r]=c}else n[r]=a,s=!0;s&&("ms-effect"===r&&(n[r]=a),kt(n,this.update))}delete t[r]},update:function(t,n){if(t&&1===t.nodeType){var r=e(t);n.dynamic["ms-css"]=1;var a=n["ms-css"];for(var o in a)r.css(o,a[o])}}}),Mo=No.diff;e.directive("attr",{diff:Mo,update:q});var jo="none";e.parseDisplay=Tt,e.directive("visible",{diff:function(e,t,n){var r=!!e[n];t.dynamic[n]&&r===t[n]||(t[n]=r,kt(t,this.update))},update:function(t,n){if(t&&1===t.nodeType){n.dynamic["ms-visible"]=1;var r,a=n["ms-visible"],o=t.style.display;a?(o===jo&&(r=n.displayValue,r||(t.style.display="")),""===t.style.display&&e(t).css("display")===jo&&e.contains(t.ownerDocument,t)&&(r=Tt(t))):o!==jo&&(r=jo,n.displayValue=o);var i=function(){void 0!==r&&(t.style.display=r)};e.applyEffect(t,n,{hook:a?"onEnterDone":"onLeaveDone",cb:i})}}}),e.directive("expr",{parse:e.noop}),e.directive("text",{parse:function(t,n,r){t[r.name]=1,n.children=[],t.children='[{\nnodeName:"#text",\ndynamic:true,\nnodeValue:avalon.parsers.string('+e.parseExpr(r)+")}]"},diff:function(e,t){t.children.length||kt(t,this.update)},update:function(e,t){if(e&&!t.isVoidTag){for(var n=e;n.firstChild;)n.removeChild(n.firstChild);var e=document.createTextNode("x");n.appendChild(e);var r={nodeType:3,nodeName:"#text",dom:e};t.children.push(r)}}}),e.directive("html",{parse:function(t,n,r){n.isVoidTag?t.children="[]":(t[r.name]=e.parseExpr(r),t.vmodel="__vmodel__",t.local="__local__")},diff:function(t,n,r){var a=t[r]+"";if(n.dynamic["ms-html"]&&n.render&&a===n[r]){if(n.render){var o=n.render(t.vmodel,t.local);t.children=o}}else{n[r]=a;var i=e.speedUp(e.lexer(a)),s=e.render(i,t.local);n.render=s;var o=s(t.vmodel,t.local);n.children=t.children=o,kt(n,this.update)}},update:function(t,n){n.dynamic["ms-html"]=1,e.clearHTML(t),t.appendChild(e.domize(n.children))}}),e.directive("class",{diff:function(e,t,n){var r=n.slice(3),a=e[n],o=t[n]||"",i=t.classEvent||{};"hover"===r?(i.mouseenter=Nt,i.mouseleave=Mt):"active"===r&&(t.props.tabindex=e.props.tabindex||-1,i.tabIndex=t.props.tabindex,i.mousedown=Nt,i.mouseup=Mt,i.mouseleave=Mt),t.classEvent=i;var s=Ot(a);t.dynamic[n]&&o===s||(t[n]=s,t["change-"+r]=s,kt(t,this.update,r))},update:function(t,n){if(t&&1===t.nodeType){var r=n.classEvent;if(r){for(var a in r)"tabIndex"===a?t[a]=r[a]:e.bind(t,a,r[a]);n.classEvent={}}var o=["class","hover","active"];o.forEach(function(r){var a="change-"+r,o=n[a];if(void 0!==o)if(n.dynamic["ms-"+r]=1,"class"===r)t&&jt(t,n);else{var i=t.getAttribute("change-"+r);i&&e(t).removeClass(i),t.setAttribute(a,o)}})}}}),zr.active=zr.hover=zr["class"];var So={mouseenter:"change-hover",mouseleave:"change-hover",mousedown:"change-active",mouseup:"change-active"};d(Nt),d(Mt);var Do=/^ms\-on\-(\w+)/;e.directive("on",{priority:3e3,parse:function(t,n,r){var a=r.name.replace("ms-on-","e").replace("-","_"),o=a+"_"+r.expr.replace(/\s/g,"").replace(/[^$a-z]/gi,function(e){return e.charCodeAt(0)}),i=e.quote(o),s="(function(){\nvar fn610 = "+e.parseExpr(r)+"\nfn610.uuid ="+i+";\nreturn fn610})()";t.vmodel="__vmodel__",t.local="__local__",t[r.name]=s},diff:function(t,n,r){var a=t[r],o=a.uuid,i=n[r]||{},s=!1;n.dynamic[r]&&i.uuid===o||(n[r]=a,e.eventListeners[o]=a,s=!0),St(n.local||{},t.local)&&(s=!0),s?(n.local=t.local,n.vmodel=t.vmodel,kt(n,this.update)):n.dom&&(n.dom._ms_local=t.local)},update:function(t,n){if(t&&1===t.nodeType){var r,a;t._ms_context_=n.vmodel,t._ms_local=n.local;for(r in n){var o=r.match(Do);o&&(a=n[r],n.dynamic[r]=1,e.bind(t,o[1],a))}}}});var Lo=e.oneObject("break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile");e.keyMap=Lo;var Vo={nodeName:1,forExpr:1,type:1,template:1,nodeValue:1,signature:1,wid:1},Fo=/[W\:-]/,Ho={input:function(e){var t=this;e=e||"value";var n=t.dom,r=n[e],a=t.parse(r);t.value=r,t.set(t.vmodel,a),Vt(t);var o=t.pos;n.caret&&t.setCaret(n,o)},radio:function(){var e=this;if(e.isChecked){var t=!e.value;e.set(e.vmodel,t),Vt(e)}else Ho.input.call(e),e.value=0/0},checkbox:function(){var t=this,n=t.value;Array.isArray(n)||(e.warn("ms-duplex应用于checkbox上要对应一个数组"),n=[n]);var r=t.dom.checked?"ensure":"remove";if(n[r]){var a=t.parse(t.dom.value);n[r](a),Vt(t)}},select:function(){var t=this,n=e(t.dom).val();n+""!=this.value+""&&(n=Array.isArray(n)?n.map(function(e){return t.parse(e)}):t.parse(n),t.set(t.vmodel,n),Vt(t))},contenteditable:function(){Ho.input.call(this,"innerHTML")}},Po=e.msie;f(Bt),f(zt),f(Rt),f(qt),f(Ft),f(Pt),f(It),f(Ut);var Io=function(e){setTimeout(e,0)},Bo=function(e,t){var n;e.createTextRange?Io(function(){e.focus(),n=e.createTextRange(),n.collapse(!0),n.moveEnd("character",t),n.moveStart("character",t),n.select()}):(e.focus(),void 0!==e.selectionStart&&e.setSelectionRange(t,t))},zo=function(e){var t,n,r,a,o,i=0;return"number"==typeof e.selectionStart&&"number"==typeof e.selectionEnd?i=e.selectionStart:(n=Yr.selection.createRange(),n&&n.parentElement()==e&&(a=e.value.length,t=e.value.replace(/\r\n/g,"\n"),r=e.createTextRange(),r.moveToBookmark(n.getBookmark()),o=e.createTextRange(),o.collapse(!1),r.compareEndPoints("StartToEnd",o)>-1?i=a:(i=-r.moveStart("character",-a),i+=t.slice(0,i).split("\n").length-1))),i},Ro=!1;try{var qo={},Uo=HTMLInputElement.prototype,Yo=HTMLTextAreaElement.prototype,Wo=function(e){qo[this.tagName].call(this,e);var t=this.__ms_duplex__;!this.caret&&t&&t.isString&&t.update.call(this,{type:"setter"})},Zo=HTMLInputElement.prototype;Object.getOwnPropertyNames(Zo),qo.INPUT=Object.getOwnPropertyDescriptor(Uo,"value").set,Object.defineProperty(Uo,"value",{set:Wo}),qo.TEXTAREA=Object.getOwnPropertyDescriptor(Yo,"value").set,Object.defineProperty(Yo,"value",{set:Wo}),Ro=!0}catch(Ar){}var Xo={input:function(){this.dom.value=this.value},radio:function(){var t;t=this.isChecked?!!this.value:this.value+""===this.dom.value;var n=this.dom;6===e.msie?setTimeout(function(){n.defaultChecked=t,n.checked=t},31):n.checked=t},checkbox:function(){for(var e=!1,t=this.dom,n=t.value,r=0;r<this.value.length;r++){var a=this.value[r];a+""===n&&(e=!0)}t.checked=e},select:function(){var t=Array.isArray(this.value)?this.value.map(String):this.value+"";e(this.dom).val(t)},contenteditable:function(){this.dom.innerHTML=this.value,this.update.call(this.dom)}},Ko=/\|\s*change\b/,Go=/^(?:checkbox|radio)$/,Jo=/\|\s*debounce(?:\(([^)]+)\))?/,Qo="ms-duplex";e.directive("duplex",{priority:2e3,parse:function(t,n,r){var a,o=r.expr,i=n.props.type,s=r.param,c=!1;s=s?s.split("-").map(function(e){return"checked"===e&&(c=!0),e}):[],Go.test(i)&&c&&(s=[],a="radio"),/input|textarea|select/.test(n.nodeName)?a||(a="select"===n.nodeName?"select":"checkbox"===i?"checkbox":"radio"===i?"radio":"input"):"contenteditable"in n.props&&(a="contenteditable");var l=!1,u=0;if("input"===a||"contenteditable"===a){var d=!0;if(Ko.test(o)&&(l=!0),!l){var f=o.match(Jo);f&&(u=parseInt(f[1],10)||300)}}var p=t.props["data-duplex-changed"],v=e.parseExpr(r),m=s.map(function(t){return e.quote(t)});t[Qo]=Lt({type:a,vmodel:"__vmodel__",local:"__local__",debug:e.quote(r.name+"="+r.expr),isChecked:c,parsers:"["+m+"]",isString:!!d,isChanged:l,debounceTime:u,get:v,set:e.evaluatorPool.get("duplex:set:"+o),callback:p?e.parseExpr({expr:p,type:"on"}):"avalon.noop"})},diff:function(e,t){if(t.dynamic[Qo])n=t[Qo];else{var n=t[Qo]=e[Qo];n.parse=Wt}e!==t&&(e[Qo]=null);var r=n.get(n.vmodel),a=n.value;if(n.isString){if(r=n.parse(r),r+="",r===a)return}else if(Array.isArray(r)){var o=!0;if(r+""===n.arrayHack)return}n.value=r,o&&(n.arayHack=r+""),kt(t,this.update,"afterChange")},update:function(t,n){if(t&&1===t.nodeType){n.dynamic[Qo]=1,t.__ms_duplex__||(t.__ms_duplex__=e.mix(n[Qo],{dom:t}),Ht(t,n),Yt(t,n));var r=t.__ms_duplex__;if(r.dom=t,r.isString&&!e.msie&&Ro===!1&&!t.valueHijack){t.valueHijack=Ft;var a=setInterval(function(){e.contains(e.root,t)?t.valueHijack({type:"poll"}):clearInterval(a)},30)}Xo[r.type].call(r)}}});var ei=e.directive("validate",{diff:function(e,t,n){var r=e[n],a=t[n];if(!(a&&a.onError&&a.addField)&&Object(r)===r){t.vmValidator=r,r.$id&&(r=r.$model),t[n]=r;for(var n in ei.defaults)r.hasOwnProperty(n)||(r[n]=ei.defaults[n]);r.fields=r.fields||[],kt(t,this.update)}},update:function(t,n){function r(){ei.validateAll.call(a,a.onValidateAll)}var a=n["ms-validate"];t._ms_validator_=a,a.dom=t;var o=n.vmValidator;try{o.onManual=r}catch(i){}delete n.vmValidator,t.setAttribute("novalidate","novalidate"),a.validateAllInSubmit&&e.bind(t,"submit",function(e){e.preventDefault(),r()}),"function"==typeof a.onInit&&a.onInit.call(t,{type:"init",target:t,validator:a})},validateAll:function(e){var t=this,n="function"==typeof e?e:t.onValidateAll,r=t.fields.filter(function(e){var n=e.dom;return n&&!n.disabled&&t.dom.contains(n)}).map(function(e){return ei.validate(e,!0)});return Promise.all(r).then(function(e){var r=e.concat.apply([],e);if(t.deduplicateInValidateAll){var a={};r=r.filter(function(e){var t=e.element,n=t.uniqueID||(t.uniqueID=setTimeout("1"));return a[n]?!1:a[n]=!0})}n.call(t.dom,r)})},addField:function(t){var n=this,r=t.dom;!n.validateInKeyup||t.isChanged||t.debounceTime||e.bind(r,"keyup",function(e){ei.validate(t,0,e)}),n.validateInBlur&&e.bind(r,"blur",function(e){ei.validate(t,0,e)}),n.resetInFocus&&e.bind(r,"focus",function(e){n.onReset.call(r,e,t)})},validate:function(t,n,r){var a=[],o=t.value,i=t.dom,s=t.validator;if("function"!=typeof Promise&&e.error("please npm install avalon-promise or bluebird"),!i.disabled){var c=t.rules;if(!c.norequired||""!==o)for(var l in c){var u=c[l];if(u!==!1){var d,f,p=e.validators[l];a.push(new Promise(function(e,t){d=e,f=t}));var v=function(e){if(e)d(!0);else{var n={element:i,data:t.data,message:i.getAttribute("data-"+l+"-message")||i.getAttribute("data-message")||p.message,validateRule:l,getMessage:Zt};d(n)}};t.data={},t.data[l]=u,p.get(o,t,v)}}return Promise.all(a).then(function(e){var t=e.filter(function(e){return"object"==typeof e});return n||(t.length?s.onError.call(i,t,r):s.onSuccess.call(i,t,r),s.onComplete.call(i,t,r)),t})}}}),ti=/\\?{{([^{}]+)\}}/gm;ei.defaults={addField:ei.addField,onError:e.noop,onSuccess:e.noop,onComplete:e.noop,onManual:e.noop,onReset:e.noop,onValidateAll:e.noop,validateInBlur:!0,validateInKeyup:!0,validateAllInSubmit:!0,resetInFocus:!0,deduplicateInValidateAll:!1},e.directive("rules",{diff:function(e,t,n){var r=e[n];if(r&&"[object Object]"===Object.prototype.toString.call(r)){t[n]=r.$model||r;var a=t.dom&&t.dom.__ms_duplex__;a&&(a.rules=e[n])}}});var ni=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/i,ri=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/;e.shadowCopy(e.validators,{pattern:{message:"必须匹配{{pattern}}这样的格式",get:function(e,t,n){var r=t.dom,a=t.data;if(!Xt(a.pattern)){var o=r.getAttribute("pattern");a.pattern=new RegExp("^(?:"+o+")$")}return n(a.pattern.test(e)),e}},digits:{message:"必须整数",get:function(e,t,n){return n(/^\-?\d+$/.test(e)),e}},number:{message:"必须数字",get:function(e,t,n){return n(!!e&&isFinite(e)),e}},norequired:{message:"",get:function(e,t,n){return n(!0),e}},required:{message:"必须填写",get:function(e,t,n){return n(""!==e),e}},equalto:{message:"密码输入不一致",get:function(t,n,r){var a=String(n.data.equalto),o=e(document.getElementById(a)).val()||"";return r(t===o),t}},date:{message:"日期格式不正确",get:function(e,t,n){var r=t.data;return n(Xt(r.date)?r.date.test(e):Kt(e)),e}},url:{message:"URL格式不正确",get:function(e,t,n){return n(ri.test(e)),e}},email:{message:"email格式不正确",get:function(e,t,n){return n(ni.test(e)),e}},minlength:{message:"最少输入{{minlength}}个字",get:function(e,t,n){var r=parseInt(t.data.minlength,10);return n(e.length>=r),e}},maxlength:{message:"最多输入{{maxlength}}个字",get:function(e,t,n){var r=parseInt(t.data.maxlength,10);return n(e.length<=r),e}},min:{message:"输入值不能小于{{min}}",get:function(e,t,n){var r=parseInt(t.data.min,10);return n(parseFloat(e)>=r),e}},max:{message:"输入值不能大于{{max}}",get:function(e,t,n){var r=parseInt(t.data.max,10);return n(parseFloat(e)<=r),e}},chs:{message:"必须是中文字符",get:function(e,t,n){return n(/^[\u4e00-\u9fa5]+$/.test(e)),e}}}),e.directive("if",{priority:6,diff:function(e,t,n){var r=!!e[n];t[n]=r,kt(t,this.update)},update:function(t,n,r){var a=n["ms-if"];if(n.dynamic["ms-if"]&&(n.dynamic["ms-if"]=n.nodeName),a){if("#comment"===n.nodeName){n.nodeName=n.dynamic["ms-if"],delete n.nodeValue;var o=n.comment;if(!o)return;r=o.parentNode,r&&r.replaceChild(t,o),delete n.comment,e.applyEffect(t,n,{hook:"onEnterDone"})}}else n.comment||(n.comment=document.createComment("if")),n.nodeName="#comment",n.nodeValue="if",e.applyEffect(t,n,{hook:"onLeaveDone",cb:function(){(r&&11!==r.nodeType||(r=t.parentNode,r&&11!==r.nodeType))&&r.replaceChild(n.comment,t)}})}});var ai=/\s+as\s+([$\w]+)/,oi=/^[$a-zA-Z_][$a-zA-Z0-9_]*$/,ii=/^(null|undefined|NaN|window|this|\$index|\$id)$/,si=/[$\w_]+/g;e._each=function(e,t,n,r){var a=[];r.push(a);var o=(t+"").slice(0,40).match(si);if(o.shift(),Array.isArray(e))for(var i=0;i<e.length;i++)Jt(i,e[i],n,t,o[0],o[1],a,!0);else for(var i in e)e.hasOwnProperty(i)&&Jt(i,e[i],n,t,o[0],o[1],a)},e.directive("for",{priority:3,parse:function(t,n){var r,a=n.forExpr;a=a.replace(ai,function(t,n){return!oi.test(n)||ii.test(n)?e.error("alias "+n+" is invalid --- must be a valid JS identifier which is not a reserved name."):r=n,""});var o=a.split(" in "),i={expr:o[1].trim(),type:"for"},s=e.parseExpr(i),c=(o[0]+" traceKey __local__ vnodes").match(si);4===c.length&&c.unshift("$key"),n.$append=Array("var loop = "+s+";","avalon._each(loop, function("+c+"){","__local__["+qr(r||"valueOf")+"] = loop","vnodes.push({",'	nodeName: "#document-fragment",',"	index   : arguments[0],","	key     : traceKey,","	children: new function(){\nvar vnodes = []\n").join("\n")},diff:function(t,n,r,a,o){if(!e.callArray||!n.list||-1!==n.forExpr.indexOf(e.callArray)){var i,s,c,l=a[o+1],u=r[o+1],d=r[o+2],f=n.cache||{},p=[];if(l.length)if(l===u){u.forEach(function(e){e.action="move",nn(f,e)}),n.cache=f;var v=!0}else{n.action="update";var m={},h=[];for(i=0;s=u[i];i++){var c=tn(f,s.key);c?(c.oldIndex=c.index,c.index=s.index,nn(m,c)):h.push(s)}for(var s,i=0;s=h[i];i++)c=en(f,s.key),c?(c.oldIndex=c.index,c.index=s.index,c.key=s.key):(c=s,l.push(c)),nn(m,c);l.sort(function(e,t){return e.index-t.index}),n.cache=m;for(var i in f)c=f[i],c.action="leave",e.Array.remove(l,c),p.push(c),c.arr&&(c.arr.forEach(function(e){e.action="leave",p.push(e)}),delete c.arr)}else n.action="init",a[o+1]=u,u.forEach(function(e,t){l[t]=e,nn(f,e)}),n.cache=f;p.length>1&&p.sort(function(e,t){return e.index-t.index}),n.removes=p;var y=e.caches[n.wid],g=t.vmodel;return d&&y&&(d.afterChange=[function(e){y.call(g,{type:"rendered",target:e,signature:n.signature})}]),v||(n.list=l,kt(n,this.update)),!0}},update:function(t,n,r){if("init"===n.action){var a=r;r=document.createDocumentFragment()}for(var o,i=t,s=n.signature,c=0;o=n.removes[c++];)o.dom&&(delete o.split,n.hasEffect?!function(e){var t=Qt(e),n=e.children.concat();e.children.length=0,ci(t,n,{hook:"onLeaveDone",staggerKey:s+"leave",cb:function(e){e.parentNode&&e.parentNode.removeChild(e)}})}(o):Qt(o,"add"));n.list.forEach(function(t,a){if("leave"!==t.action){t.dom||(t.dom=e.domize(t));var o=t.dom;if(void 0===t.oldIndex){if(n.hasEffect)var c=e.slice(o.childNodes);0===a&&"init"===n.action?r.appendChild(o):r.insertBefore(o,i.nextSibling),n.hasEffect&&ci(c,t.children,{hook:"onEnterDone",staggerKey:s+"enter"})}else if(t.index!==t.oldIndex){var c=Qt(t,"add");r.insertBefore(t.dom,i.nextSibling),n.hasEffect&&ci(c,t.children,{hook:"onMoveDone",staggerKey:s+"move"})}i=t.split}}),"init"===n.action&&a.insertBefore(r,t.nextSibling)}});var ci=function(t,n,r){n.forEach(function(n,a){e.applyEffect(t[a],n,r)})},li=rn(e.cssName("transition-duration"),e.cssName("animation-duration"),e.window);e.directive("effect",{priority:5,diff:function(t,n,r){var a=t[r];"string"==typeof a&&(t[r]={is:a},e.warn("ms-effect的指令值不再支持字符串,必须是一个对象")),Mo.call(this,t,n,r,"afterChange")},update:function(t,n,r,a){if(t&&1===t.nodeType){var o="ms-effect",i=n[o]||a||{};n.dynamic[o]=1;var s=i.is;if(!s)return e.warn("need is option");var c=e.effects;li.css&&!c[s]&&e.effect(s);var l=c[s];if(!l)return e.warn(s+" effect is undefined");var u={},d=i.action;"boolean"==typeof d&&(u.action=d?"enter":"leave");var f=e.Effect,p=new f(t);e.mix(u,l,i),t.animating=u.action,u.queue?(ui.push(function(){p[d](u)}),an()):setTimeout(function(){p[d](u)},4)}}});var ui=[];e.effect=function(t,n){var r=e.effects[t]=n||{};li.css&&r.css!==!1&&(on(r,"enterClass",t+"-enter"),on(r,"enterActiveClass",r.enterClass+"-active"),on(r,"leaveClass",t+"-leave"),on(r,"leaveActiveClass",r.leaveClass+"-active")),on(r,"action","enter")};var di=function(e){this.el=e};e.Effect=di,di.prototype={enter:ln("Enter"),leave:ln("Leave"),move:ln("Move")};var fi=/\d+s$/,pi=new u(128);e.applyEffect=function(t,n,r){var a=r.cb,o=n["ms-effect"];if(o&&t&&1===t.nodeType){var i=r.hook,s=o[i];a&&(Array.isArray(s)?s.push(a):o[i]=s?[s,a]:[a]),un(r),e.directives.effect.update(t,n,0,e.shadowCopy({},r))}else a&&a(t)};var vi=0,mi={map:{}},hi=/\?\?\d+/g,yi=/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi,gi=e.oneObject("script,style,textarea,xmp,noscript,option,template"),_i=/^<([-A-Za-z0-9_]+)\s*([^>]*?)(\/?)>/,bi=/^<\/([^>]+)>/,wi=/\S/,xi=/[\n\r]s*/g,$i=/([^=\s]+)(?:\s*=\s*(\S+))?/,Ci=function(){return{children:[],props:{}}},Ei=/^ms-(\w+)-?(.*)/,Ai=[],ki=!1;e.suspendUpdate=0;var Ti=/^(\:|ms\-)\w+/,Oi=e.oneObject("animationend,blur,change,input,click,dblclick,focus,keydown,keypress,keyup,mousedown,mouseenter,mouseleave,mousemove,mouseout,mouseover,mouseup,scan,scroll,submit"),Ni=e.config,Mi=e.quote,ji=/^[$a-zA-Z_][$a-zA-Z0-9_]*$/,Si=/^\s*var\s+([$\w]+)\s*\=\s*\S+/,Di={__local__:1,vmode:1,dom:1},Li=/\n\s*/g,Vi=/^\s*ms\-for\:\s*/,Fi=/^\s*ms\-for\-end/,Hi=function(t){for(var n=[],r=!1,a=0;a<t.length;a++){var o=t[a],i="#comment"===o.nodeName;if(i&&Vi.test(o.nodeValue)){r=!0,n.push(o);var s=n;n=[],n.list=s,n.start=o}else if(i&&Fi.test(o.nodeValue)){var s=n;n=s.list;var c=s.start;delete s.list,delete s.start,n.push(s,o),o.dynamic=!0;var l=c.signature||(c.signature=e.makeHashCode("for"));if(o.signature=l,c.forExpr=c.nodeValue.replace(Vi,""),1===s.length){var u=s[0];if(u.props){u.props.slot&&(c.props='{slot: "'+u.props.slot+'"}');var d=u.props["data-for-rendered"];if(d){delete u.props["data-for-rendered"];var f=d+":cb";e.caches[f]||(e.caches[f]=Function("return "+e.parseExpr({type:"on",expr:d}))()),c.wid=f}}}for(var p=0;p<s.length;p++){var o=s[p],v=o.dom;v&&v.parentNode&&v.parentNode.removeChild(v)}c.hasEffect=Pn(s),Hi(s),e.caches[l]||(e.caches[l]=On(s,!0)),s.length=0}else Fn(o)&&(r=!0),n.push(o)}return t.length=0,t.push.apply(t,n),r},Pi=e.evaluatorPool,Ii=/\(([^)]*)\)/,Bi=/\|\|/g,zi=/\|(?=\?\?)/,Ri=/\s*(\.|\|)\s*/g,qi=/^__vmodel__\.[$\w\.]+$/i,Ui=/(^|[^\w\u00c0-\uFFFF_])(@|##)(?=[$\w])/g,Yi=/\.[\w\.\$]+/g,Wi=/[$a-zA-Z_][$a-zA-Z0-9_]*/g,Zi=/(^|[^\/])\/(?!\/)(\[.+?]|\\.|[^\/\\\r\n])+\/[gimyu]{0,5}(?=\s*($|[\r\n,.;})]))/g;e.lexer=gn,e.diff=$n,e.batch=An,e.speedUp=Vn,e.parseExpr=In;var Xi=/\\\\(['"])/g;e.render=Un;var Ki={wbr:1,xmp:1,template:1},Gi="onInit,onReady,onViewChange,onDispose",Ji=e.oneObject(Gi),Qi=Gi.split(",").concat("is","define"),es=!0;e.insertSlots=function(t,n){for(var r,a=0;r=t[a];a++)if("#comment"===r.nodeName&&n[r.type]){var o=[a+1,0].concat(n[r.type]);t.splice.apply(t,o),a+=n[r.type].length}else r.children&&e.insertSlots(r.children,n)},e.collectSlots=function(e,t){var n={};return t?(n[t]=e.children,n.__sole__=t):e.children.forEach(function(t,r){var a=t.props&&t.props.slot;a&&(t.forExpr?n[a]=e.children.slice(r,r+2):Array.isArray(n[a])?n[a].push(t):n[a]=[t])}),n};var ts=/^[a-z]([a-z\d]+\-)+[a-z\d]+$/,ns=/^\w/,rs=[],as=0;return ir.byMutationEvent=rr,ir.byRewritePrototype=ar,ir.byPolling=or,e._disposeComponent=ir,e.component=function(t,n){e.components[t]||(e.components[t]=n)},e.directive("widget",{priority:4,parse:function(t,n,r){n.props.wid=n.props.wid||e.makeHashCode("w"),t[r.name]=e.parseExpr(r),t.template=n.template,t.vmodel="__vmodel__",t.local="__local__"},define:function(){return e.mediatorFactory.apply(this,arguments)},diff:function(t,n,r,a,o,i){var s=t[r];if(Object(s)===s){var c=n.props.is||(/^ms\-/.test(n.nodeName)?n.nodeName:0);c||(s=s.$model||s,Array.isArray(s)&&(s.unshift({}),e.mix.apply(0,s),s=s.shift()),c=s.is);var l="component-vm:"+c;if(n.props.is=c,n.vmodel=t.vmodel,!n[l]&&!Yn(n,t[r],t.local,t.template))return n.nodeValue="unresolved component placeholder",a[i]=n,void kt(n,this.mountComment);var u=n[l],d=e.scopes[u.$id];if(d&&d.vmodel){var f=d.vmodel.$element;if(n.dom!==f){var p=f.vtree[0];return o[i]=a[i]=p,n.com=f,p.skipContent||(p.skipContent="optimize"),kt(n,this.replaceCachedComponent),void kt(p,function(){"optimize"===p.skipContent&&(p.skipContent=!0)},"afterChange")}}var v=u.$render,m=v(u,t.local),p=m[0];p&&cr(p)?(p.local=t.local,Array(l,"component-html:"+c,"component-ready:"+c,"dom","dynamic").forEach(function(e){p[e]=n[e]}),p.vmodel=u,a[i]=p,n.comment&&n.nodeValue&&(p.dom=n.comment),n.nodeName!==p.nodeName?(o[i]=p,kt(p,this.mountComponent)):kt(n,this.updateComponent)):(n.nodeValue="unresolved component placeholder",a[i]={nodeValue:"unresolved component placeholder",nodeName:"#comment"},kt(n,this.mountComment))}else n.props.is===t.props.is&&kt(n,this.updateComponent)},replaceCachedComponent:function(e,t,n){var r=t.com;n.replaceChild(r,e),t.dom=r,delete t.com},mountComment:function(e,t,n){var r=document.createComment(t.nodeValue);t.dom=r,n.replaceChild(r,e)},updateComponent:function(e,t){var n=t["component-vm:"+t.props.is],r=n.$events.onViewChange;r&&r.length&&kt(t,sr,"afterChange")},mountComponent:function(t,n,r){delete n.dom;var a=e.vdom(n,"toDOM"),o=n.props.is,i=n["component-vm:"+o];i.$fire("onInit",{type:"init",vmodel:i,is:o}),r.replaceChild(a,t),n.dom=i.$element=a,a.vtree=[n],e._disposeComponent(a),n["component-ready:"+o]=!0,e.scopes[i.$id]={vmodel:i,top:n.vmodel,local:n.local},kt(n,function(){i.$fire("onReady",{type:"ready",target:a,vmodel:i,is:o})},"afterChange"),kt(n,function(){n["component-html:"+o]=e.vdom(n,"toHTML")},"afterChange")}}),e})});
function setCookie(t,i){var s=365,o=new Date;o.setTime(o.getTime()+24*s*60*60*1e3),document.cookie=t+"="+escape(i)+";expires="+o.toGMTString()}function getCookie(t){var i,s=new RegExp("(^| )"+t+"=([^;]*)(;|$)");return(i=document.cookie.match(s))?unescape(i[2]):null}function subString(t,i,s){for(var o=0,e="",n=/[^\x00-\xff]/g,a="",c=t.replace(n,"**").length,r=0;c>r&&(a=t.charAt(r).toString(),null!=a.match(n)?o+=2:o++,!(o>i));r++)e+=a;return s&&c>i&&(e+="..."),e}var avalon=require("shihuo:widget/js/avalon.js");avalon.config({debug:!1});var vm=avalon.define({$id:"home_index",msgVal:null,tpl:"",template:{signIn:'<a href="javascript:;" class="user_sign" ms-click="@sign"> 签到领金币</a>',novice:'<a class="user_sign_btn" id="haitao_new_user" href="javascript:;" ms-click="@newUser">新手教程领红包</a>',haitaoSignIn:'<a class="user_sign_btn" style="padding: 0 5px 0 0;line-height: 26px;" ms-click="@haitaoSignInAjax" target="_blank" href="//s.click.taobao.com/t?e=m%3D2%26s%3D9nkvLHO20YgcQipKwQzePCperVdZeJviK7Vc7tFgwiFRAdhuF14FMc1d4jzmKGnl1aH1Hk3GeOhGtvS2t8YXqo2WrrQZ4Yz3yZZSwiMazoFzguIHwwNmQ6UuZxIcp9pfUIgVEmFmgnbDX0%2BHH2IEVeOhxeU7PAMffjxl6AIniNqFaHIuh%2BHFNwnnzBg0eKfQ9lt7v5PVWvFxi50NQTy4XDmKuA4B%2FVj5nc8sjvQiJFXUHOq7NaicK8YOae24fhW0"><img src="//sh1.hoopchina.com.cn/images/trade/discount/tmall-icon.png" style="position: relative;padding: 0 5px 0 0;font-size: 14px;margin:0px;" />天猫超市+1金币</a>',finish:'<span class="user_sign_btn" href="javascript:;" style="cursor:auto; border:1px #FF4338 solid; background-color:#fff; color:#FF4338;"><img src="//www.shihuo.cn/images/trade/discount/qdicon.jpg" style="position:relative;top:-2px;" /> 今日已签到</span>',noviceFinish:'<a class="user_sign_btn" href="//www.shihuo.cn/ucenter/myCoupon"><img src="//www.shihuo.cn/images/trade/discount/qdicon.jpg" /> 已领取，去查看</a>'},publishDate:null,pageParam:pageParam,arrData:[],lodingShow:!0,userName:"",userGold:"",lodingMoreList:0,lodingMoreLoding:!1,newsLengthCount:1*newsLengthCount,sign:function(){var t=$(".user_sign"),i=this;$.post("/ucenter/signin",{},function(s){0==$.trim(s.status)&&($('<div id="integration" style="position: absolute; color:#e24c52; font-weight:bold;">+'+s.integral+"</div>").appendTo("body"),$("#integration").css({left:t.offset().left+40,top:t.offset().top}),$("#integration").animate({top:t.offset().top-15},500),$("#jb-num-area").html(1*$("#jb-num-area").html()+1*s.integral),setTimeout(function(){$("#integration").remove(),i.getuserTask()},1500))},"json")},getuserTask:function(){var t=this;$.post("/shihuo/userTask",{},function(i){"notLogin"==i.datas.data.status?t.msgVal=i.datas.data.status:(t.msgVal=i.datas.data.status,t.userName=subString(i.datas.userAccount.hupu_username,15,!0),t.userGold=i.datas.userAccount.gold)},"json")},haitaoSignInAjax:function(){var t=this;$.post("/ucenter/haitaoSign",{},function(i){1*i.status==0&&t.getuserTask()},"json")},lodingMore:function(){var t,i=this;return i.lodingMoreLoding?!1:(i.lodingMoreLoding=!0,void $.post("/shihuo/getLists",{page_size:18,page_param:i.pageParam},function(s){if(0!=s.datas.news){i.arrData=i.arrData.concat(s.datas.news);for(t in s.datas.ads)"xinxiliu"==t.split("_")[0]&&t.split("_").length>1&&i.arrData.length+i.newsLengthCount>1*t.split("_")[1]-1&&i.arrData[1*t.split("_")[1]-1-i.newsLengthCount].id!=s.datas.ads[t].id&&i.arrData.splice(1*t.split("_")[1]-1-i.newsLengthCount,0,s.datas.ads[t]);vm.pageParam=$(".getpublishDate-list:last").attr("pageParam"),vm.reloadsubStringTxt(),0==s.datas.news.length&&(i.lodingShow=!1)}i.lodingMoreLoding=!1},"json"))},setMessageRecommendData:function(t,i){var s={dataType:i,productId:t,platform:"PC"};$.getJSON("/praise/praiseHomeNew",s,function(i){if(200==i.status){var s;$(".setMessageRecommend-zan").each(function(){$(this).attr("productid")==t&&(s=$(this))}),1==i.data?(s.text(1*s.text()+1),s.addClass("on")):(s.text(1*s.text()-1),s.removeClass("on"))}402==i.status&&(window.location.href="https://passport.shihuo.cn/login?project=shihuo&from=pc")})},reloadsubStringTxt:function(){$(".hot_disc").each(function(){$(this).text(subString($(this).text(),60,!0))})},onMousemove:function(){},writeDom:function(){"signIn"==vm.msgVal&&(vm.tpl=vm.template.signIn),"novice"==vm.msgVal&&(vm.tpl=vm.template.novice,tryCourse.init()),"haitaoSignIn"==vm.msgVal&&(vm.tpl=vm.template.haitaoSignIn),"finish"==vm.msgVal&&(vm.tpl=vm.template.finish),"noviceFinish"==vm.msgVal&&(vm.tpl=vm.template.noviceFinish)}});vm.$watch("msgVal",function(){vm.writeDom()}),avalon.ready(function(){function t(){setTimeout(function(){i=$(".hot-yh").offset().top,t()},100)}$(".J_ui_picSwitch").slide({css:{width:540,height:250},config:{time:5e3,type:"fade",speed:600,button:!0,butArr:".J_ui_picSwitch .J_ui_a li"},completes:function(){$(".J_ui_picSwitch").hover(function(){$(".J_ui_butPost_a,.J_ui_butPost_b").show()},function(){$(".J_ui_butPost_a,.J_ui_butPost_b").hide()}),$(".J_ui_butPost_a,.J_ui_butPost_b").css({opacity:.6}),$(".J_ui_butPost_a,.J_ui_butPost_b").hover(function(){$(this).css({opacity:1})},function(){$(this).css({opacity:.6})})},before:function(){},after:function(){}}),$(".menu_nav li").eq(0).find("a").addClass("on"),vm.getuserTask(),vm.reloadsubStringTxt(),youhuiSolid.init();var i=$(".hot-yh").offset().top;t(),$(window).bind("scroll",function(){var t=$(window).scrollTop()+$(window).height(),s=$(".list-block").height()+$(".list-block").offset().top;$(window).scrollTop()>i&&$(window).scrollTop()<1*$(".list-block").offset().top+1*$(".list-block").height()-650?$(".hot-fixed").addClass("right-list-fixed"):$(".hot-fixed").removeClass("right-list-fixed"),t>=s&&!vm.lodingMoreLoding&&vm.lodingMoreList<10&&(vm.lodingMoreList++,vm.lodingMore())}),$("#group-hot li").hover(function(){$(this).find(".layer").show(),$(this).find(".title").show()},function(){$(this).find(".layer").hide(),$(this).find(".title").hide()}),$(".list-v1,.hor-area li").live("mousemove",function(){$(this).addClass("moveyy")}),$(".list-v1,.hor-area li").live("mouseout",function(){$(this).removeClass("moveyy")});var s='<a href="//www.shihuo.cn/shihuo/recommand" class="xbtc-icon" target="_blank"></a>';$(s).appendTo("body")});var tryCourse={isLoding:!1,init:function(){$.getScript("//www.shihuo.cn/js/trade/discount/jquery.zclip.js",function(){}),this.bindFun()},bindFun:function(){var t=this;$("#haitao_new_user").live("click",function(){t._showMasks(.8),t.courseA()}),$("#course_class1").live("click",function(){t.courseClsoe(),t.courseB()}),$("#course_class2").live("click",function(){t.courseClsoe(),t.tryOutA()}),$("#tryout_class1").live("click",function(){t.courseClsoe(),t.tryOutB()}),$("#tryout_class2").live("click",function(){t.courseClsoe(),t.tryOutC()}),$("#tryout_class3").live("click",function(){t.ajaxLodingFun(1)}),$("#see_algin").live("click",function(){t.ajaxLodingFun(2)}),$(".close-course-try2").live("click",function(){t.ajaxLodingFun(1)}),$(".close-course-try,.close-course-try2").live("click",function(){t.courseClsoe(),t._closeMasks()})},ajaxLodingFun:function(t){var i=this;return i.isLoding?!1:(i.isLoding=!0,void $.post("//www.shihuo.cn/ucenter/noviceFinish",{},function(s){1*s.status==1?(1==t?(i.courseClsoe(),i._closeMasks()):(i.courseClsoe(),i.courseA()),$.post("//www.shihuo.cn/shihuo/userTask",{type:1},function(t){$("#user-task").html(t),setTimeout(function(){$.post("//www.shihuo.cn/shihuo/userTask",{},function(t){$("#user-task").html(t)},"html")},"3000")},"html")):(i.courseClsoe(),2==t?i.courseA():i._closeMasks()),i.isLoding=!1},"json"))},courseA:function(){var t='<div class="course-class1" style="display:none; position:absolute; left:'+($(".logos-box .search").offset().left-140)+'px; top:4px; z-index:95;">                             <img src="//www.shihuo.cn/images/trade/discount/course/j1.png" />                             <div class="next" style="text-align: center; color:#fff; margin-top:40px;"><span id="course_class1" style="font-size:24px; border-radius:8px; background-color:#e24c52; padding:8px 25px; display:inline-block; cursor: pointer;">下一步</span></div>                      </div><div class="close-course-try" style="position:absolute; right:20px; top:20px; z-index:96; cursor: pointer;"><img src="//www.shihuo.cn/images/trade/discount/course/close.png" /></div>';$(t).appendTo("body"),$(".course-class1").fadeIn()},courseB:function(){var t='<div class="course-class1" style="display:none; position:absolute; left:'+($(".logos-box .search").offset().left-80)+'px; top:4px; z-index:95;">                             <img src="//www.shihuo.cn/images/trade/discount/course/j2.png" />                             <div class="next" style="text-align: center; color:#fff; margin-top:40px;"><span id="course_class2" style="font-size:24px; border-radius:8px; background-color:#e24c52; padding:8px 25px; display:inline-block; cursor: pointer;">立即试用</span></div>                      </div><div class="close-course-try" style="position:absolute; right:20px; top:20px; z-index:96; cursor: pointer;"><img src="//www.shihuo.cn/images/trade/discount/course/close.png" /></div>';$(t).appendTo("body"),$(".course-class1").fadeIn()},tryOutA:function(){var t='<div class="course-class1" style="display:none; position:absolute; left:'+($(".logos-box .search").offset().left-80)+'px; top:144px; z-index:95;">                             <img src="//www.shihuo.cn/images/trade/discount/course/s1.png" />                             <p style="font-size:24px; color:#fff; text-align: center; margin-top:30px;">“ //www.amazon.com/dp/B00RD5G3RE/ ”</p>                             <div class="next" style="text-align: center; color:#fff; margin-top:40px;"><span id="tryout_class1" style="font-size:24px; border-radius:8px; background-color:#e24c52; padding:8px 25px; display:inline-block; cursor: pointer;">复制</span></div>                      </div><div class="close-course-try" style="position:absolute; right:20px; top:20px; z-index:96; cursor: pointer;"><img src="//www.shihuo.cn/images/trade/discount/course/close.png" /></div>';$(t).appendTo("body"),$(".course-class1").fadeIn(),$("#tryout_class1").zclip({path:"//www.shihuo.cn/js/trade/discount/ZeroClipboard.swf",copy:"//www.amazon.com/dp/B00RD5G3RE/",afterCopy:function(){}})},tryOutB:function(){var t='<div class="course-class1" style="display:none; position:absolute; left:'+$(".logos-box .search").offset().left+'px; top:35px; z-index:95;">                             <div class="try-seach"><input type="text" style="width:364px; height:36px; line-height:36px; padding-left:10px; border:2px #ad0007 solid; background-color:#fff; vertical-align: middle;" /><span style="width:86px; height:40px; display:inline-block; text-align: center; color:#fff; line-height:40px; background-color:#ad0007; font-size:18px; vertical-align: middle; cursor: pointer;" id="tryout_class2">搜索</span></div>                             <img src="//www.shihuo.cn/images/trade/discount/course/s2.png" />                      </div><div class="close-course-try" style="position:absolute; right:20px; top:20px; z-index:96; cursor: pointer;"><img src="//www.shihuo.cn/images/trade/discount/course/close.png" /></div>';$(t).appendTo("body"),$(".course-class1").fadeIn()},tryOutC:function(){var t='<div class="course-class1" style="display:none; position:absolute; left:'+($(".logos-box .search").offset().left-80)+'px; top:44px; z-index:95;">                             <img src="//www.shihuo.cn/images/trade/discount/course/s3.png" />                             <div class="next" style="text-align: center; color:#fff; margin-top:18px;"><span id="tryout_class3" style="font-size:24px; border-radius:8px; background-color:#e24c52; padding:8px 25px; display:inline-block; cursor: pointer;">立即体验</span><span style="color:#c9c9c9; font-size:18px; margin-left:10px; cursor:pointer;" id="see_algin">再看一遍</span></div>                      </div><div class="close-course-try2" style="position:absolute; right:20px; top:20px; z-index:96; cursor: pointer;"><img src="//www.shihuo.cn/images/trade/discount/course/close.png" /></div>';$(t).appendTo("body"),$(".course-class1").fadeIn()},courseClsoe:function(){$(".course-class1,.close-course-try,.close-course-try2").remove()},_showMasks:function(t){var i="<div class='body-mask' style='position:fixed; top:0; left:0; width:100%; height:"+$(window).height()+"px; background-color:#000;  z-index:91;'></div>";$("body").append(i),$(".body-mask").css("opacity",0),$(".body-mask").animate({opacity:t?t:"0.8"})},_closeMasks:function(){var t=$(".body-mask");t.fadeOut(function(){t.remove()})}},youhuiSolid={list:0,page:1,ajaxLoding:!1,init:function(){var t=$("#yh_list_area li").length*$("#yh_list_area li").width()+100;$("#yh_list_area").width(t),this.bindFun()},bindFun:function(){var t=this;$(".list-youhui").hover(function(){t.list>0?4==t.list?$(".yh-left-btn").show():$(".yh-right-btn,.yh-left-btn").show():$(".yh-right-btn").show()},function(){$(".yh-right-btn,.yh-left-btn").hide()}),$(".yh-right-btn,.yh-left-btn").hover(function(){$(this).find(".bg-color").css({opacity:1})},function(){$(this).find(".bg-color").css({opacity:.6})}),$(".yh-left-btn").click(function(){console.log(t.list+"|"+t.page),t.list>0&&(t.list--,$("#yh_list_area").stop().animate({left:5*-($("#yh_list_area li").width()+15)*t.list},500),0==t.list&&$(this).hide(),$(".yh-right-btn").show())}),$(".yh-right-btn").click(function(){if(t.page!=t.list+1)t.list++,$("#yh_list_area").stop().animate({left:5*-($("#yh_list_area li").width()+15)*t.list},500),$(".yh-left-btn").show(),5==t.page&&t.list+1==5&&$(".yh-right-btn").hide();else{if(t.ajaxLoding)return!1;t.ajaxLoding=!0,t.page++,$.post("/shihuo/youhuiLists",{page:t.page+1,page_size:5},function(i){for(var s="",o=0;o<i.news.length;o++)if(s+='<li>	                          <div class="img">	                             <a href="'+i.news[o].detail_url+'#qk=youhuiguide" target="_blank"><img src="'+i.news[o].img_path+'" /></a>	                          </div>	                          <div class="title">	                             <a href="'+i.news[o].detail_url+'#qk=youhuiguide" target="_blank">'+i.news[o].title+'</a>	                          </div>	                          <div class="tips">'+i.news[o].subtitle+"</div>	                     </li>",5==t.page&&3==o){s+='<li>	                  	    <a href="//www.shihuo.cn/youhui" target="_blank" class="more-yh"></a>	                     </li>',$(".yh-right-btn").hide();break}$("#yh_list_area").append(s),$("#yh_list_area").width($("#yh_list_area li").length*($("#yh_list_area li").width()+15)+100),t.list++,$("#yh_list_area").animate({left:5*-($("#yh_list_area li").width()+15)*t.list},500),$(this).hide(),$(".yh-left-btn").show(),t.ajaxLoding=!1},"json")}})}};
!function(t){var i=function(){var i=arguments,s={css:{width:627,height:250},config:{time:3e3,type:"fade",speed:800,button:!1,butArr:".J_ui_picSwitch .J_ui_a li"},before:function(){},after:function(){}};return this.each(function(){var e=t(this),n=function(t){return e.find(t)},r={list:0,options:["top","left","fade"],animated:!1,init:function(){if(this.arrays=[],this.arrays[0]=t.extend(!0,{},s,arguments[0]||{}),this.ul=n(".J_ui_post"),this.li=n(".J_ui_post li"),this.but=this.arrays[0].config.butArr,-1!==this.options.index(this.arrays[0].config.type)){for(var i=0;i<this.arrays.length;i++)switch(typeof this.arrays[i]){case"object":e.css(this.arrays[i].css),this.li.css(this.arrays[i].css),this.returnBefore=this.arrays[i].before,this.returnAfter=this.arrays[i].after}this.config("move"),this.bindFun(),this.arrays[0].completes&&this.arrays[0].completes(e)}else t.error=console.error,t.error("参数格式不正确！")},config:function(){var i=this,s=0,n=i.but.split(","),r=i.arrays[0].config,l="top"==r.type?["top"]:["left"];for("left"==r.type||"top"==r.type?("left"==r.type&&(i.ul.addClass("J_ui_postFloat"),i.ul.width(e.width()*i.li.length)),i.list==i.li.length&&("top"==r.type?i.li.first().css(l[0],i.ul.height()):i.li.first().css(l[0],i.ul.width()),i.callback=function(){i.li.first().css(l[0],0),i.ul.css(l[0],0),i.list=0}),-1==i.list&&("top"==r.type?i.li.last().css(l[0],-i.ul.height()):i.li.last().css(l[0],-i.ul.width()),i.callback=function(){i.list=i.li.length-1,i.li.last().css(l[0],0),"top"==r.type?i.ul.css(l[0],-parseInt(e.height())*i.list):i.ul.css(l[0],-parseInt(e.width())*i.list)}),i.scrollA()):"fade"==r.type&&(i.ul.hasClass("J_ui_postPost")||i.ul.addClass("J_ui_postPost"),i.list==i.li.length&&(i.list=0),i.fadeFun());s<n.length;s++)t(n[s]).eq(i.list==i.li.length?0:i.list).siblings().removeClass("on"),t(n[s]).eq(i.list==i.li.length?0:i.list).addClass("on")},scrollA:function(){this.animated=!0;var t,i=this,s=i.arrays[0].config;clearTimeout(i.t),i.rerurnFun(0),t="top"==s.type?{top:-parseInt(e.height())*i.list}:{left:-parseInt(e.width())*i.list},i.ul.stop(!0).textAnimation({css:t,config:s,callback:function(){i.callback&&(i.callback(),i.callback=null),i.animated=!1,i.rerurnFun(1)}}),i.setTime()},fadeFun:function(){var t=this;clearTimeout(t.t),t.rerurnFun(0),t.li.css("opacity",1),t.li.eq(t.list).siblings().stop(!0).fadeOut(t.arrays[0].config.speed),t.li.eq(t.list).fadeIn(t.arrays[0].config.speed,function(){t.rerurnFun(1)}),t.setTime()},bindFun:function(){var i=this;t(i.but).hover(function(){i.list=t(this).index(),i.config("stop"),clearTimeout(i.t)},function(){i.setTime()}),i.li.hover(function(){clearTimeout(i.t)},function(){i.setTime()}),i.arrays[0].config.button?(n(".J_ui_butPost_a").click(function(){return i.animated?!1:(i.list-=1,void i.config("move"))}),n(".J_ui_butPost_b").click(function(){return i.animated?!1:(i.list+=1,void i.config("move"))})):(n(".J_ui_butPost_b").remove(),n(".J_ui_butPost_a").remove())},rerurnFun:function(t){t?!!this.returnAfter&&this.returnAfter(this.list==this.li.length?0:this.list):!!this.returnBefore&&this.returnBefore(this.list==this.li.length?0:this.list)},setTime:function(){var t=this;t.t=setTimeout(function(){t.list+=1,t.config("move")},t.arrays[0].config.time)}};r.init.apply(r,i)})},s={css:{top:0},config:{speed:800,easing:"swing",time:0}},e=function(i){return this.each(function(){var e=t(this),n=t.extend(!0,{},s,i);e.animate(n.css,n.config.speed,n.config.easing,function(){!!n.callback&&n.callback()})})};t.extend(Array.prototype,{has:function(t){return-1!==this.index(t)},index:function(t){if(this.indexOf)return this.indexOf(t);for(var i=0,s=this.length;s>i;i++)if(t==this[i])return i;return-1}}),t.fn.extend({textAnimation:e,slide:i})}(jQuery);
!function(t){t.fn.qrcode=function(e){function r(t){this.mode=u,this.data=t}function o(t,e){this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function n(t,e){if(void 0==t.length)throw Error(t.length+"/"+e);for(var r=0;r<t.length&&0==t[r];)r++;this.num=Array(t.length-r+e);for(var o=0;o<t.length-r;o++)this.num[o]=t[o+r]}function i(t,e){this.totalCount=t,this.dataCount=e}function s(){this.buffer=[],this.length=0}var u;r.prototype={getLength:function(){return this.data.length},write:function(t){for(var e=0;e<this.data.length;e++)t.put(this.data.charCodeAt(e),8)}},o.prototype={addData:function(t){this.dataList.push(new r(t)),this.dataCache=null},isDark:function(t,e){if(0>t||this.moduleCount<=t||0>e||this.moduleCount<=e)throw Error(t+","+e);return this.modules[t][e]},getModuleCount:function(){return this.moduleCount},make:function(){if(1>this.typeNumber){for(var t=1,t=1;40>t;t++){for(var e=i.getRSBlocks(t,this.errorCorrectLevel),r=new s,o=0,n=0;n<e.length;n++)o+=e[n].dataCount;for(n=0;n<this.dataList.length;n++)e=this.dataList[n],r.put(e.mode,4),r.put(e.getLength(),a.getLengthInBits(e.mode,t)),e.write(r);if(r.getLengthInBits()<=8*o)break}this.typeNumber=t}this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(t,e){this.moduleCount=4*this.typeNumber+17,this.modules=Array(this.moduleCount);for(var r=0;r<this.moduleCount;r++){this.modules[r]=Array(this.moduleCount);for(var n=0;n<this.moduleCount;n++)this.modules[r][n]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,e),7<=this.typeNumber&&this.setupTypeNumber(t),null==this.dataCache&&(this.dataCache=o.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,e)},setupPositionProbePattern:function(t,e){for(var r=-1;7>=r;r++)if(!(-1>=t+r||this.moduleCount<=t+r))for(var o=-1;7>=o;o++)-1>=e+o||this.moduleCount<=e+o||(this.modules[t+r][e+o]=r>=0&&6>=r&&(0==o||6==o)||o>=0&&6>=o&&(0==r||6==r)||r>=2&&4>=r&&o>=2&&4>=o?!0:!1)},getBestMaskPattern:function(){for(var t=0,e=0,r=0;8>r;r++){this.makeImpl(!0,r);var o=a.getLostPoint(this);(0==r||t>o)&&(t=o,e=r)}return e},createMovieClip:function(t,e,r){for(t=t.createEmptyMovieClip(e,r),this.make(),e=0;e<this.modules.length;e++)for(var r=1*e,o=0;o<this.modules[e].length;o++){var n=1*o;this.modules[e][o]&&(t.beginFill(0,100),t.moveTo(n,r),t.lineTo(n+1,r),t.lineTo(n+1,r+1),t.lineTo(n,r+1),t.endFill())}return t},setupTimingPattern:function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=0==t%2);for(t=8;t<this.moduleCount-8;t++)null==this.modules[6][t]&&(this.modules[6][t]=0==t%2)},setupPositionAdjustPattern:function(){for(var t=a.getPatternPosition(this.typeNumber),e=0;e<t.length;e++)for(var r=0;r<t.length;r++){var o=t[e],n=t[r];if(null==this.modules[o][n])for(var i=-2;2>=i;i++)for(var s=-2;2>=s;s++)this.modules[o+i][n+s]=-2==i||2==i||-2==s||2==s||0==i&&0==s?!0:!1}},setupTypeNumber:function(t){for(var e=a.getBCHTypeNumber(this.typeNumber),r=0;18>r;r++){var o=!t&&1==(e>>r&1);this.modules[Math.floor(r/3)][r%3+this.moduleCount-8-3]=o}for(r=0;18>r;r++)o=!t&&1==(e>>r&1),this.modules[r%3+this.moduleCount-8-3][Math.floor(r/3)]=o},setupTypeInfo:function(t,e){for(var r=a.getBCHTypeInfo(this.errorCorrectLevel<<3|e),o=0;15>o;o++){var n=!t&&1==(r>>o&1);6>o?this.modules[o][8]=n:8>o?this.modules[o+1][8]=n:this.modules[this.moduleCount-15+o][8]=n}for(o=0;15>o;o++)n=!t&&1==(r>>o&1),8>o?this.modules[8][this.moduleCount-o-1]=n:9>o?this.modules[8][15-o-1+1]=n:this.modules[8][15-o-1]=n;this.modules[this.moduleCount-8][8]=!t},mapData:function(t,e){for(var r=-1,o=this.moduleCount-1,n=7,i=0,s=this.moduleCount-1;s>0;s-=2)for(6==s&&s--;;){for(var u=0;2>u;u++)if(null==this.modules[o][s-u]){var h=!1;i<t.length&&(h=1==(t[i]>>>n&1)),a.getMask(e,o,s-u)&&(h=!h),this.modules[o][s-u]=h,n--,-1==n&&(i++,n=7)}if(o+=r,0>o||this.moduleCount<=o){o-=r,r=-r;break}}}},o.PAD0=236,o.PAD1=17,o.createData=function(t,e,r){for(var e=i.getRSBlocks(t,e),n=new s,u=0;u<r.length;u++){var h=r[u];n.put(h.mode,4),n.put(h.getLength(),a.getLengthInBits(h.mode,t)),h.write(n)}for(u=t=0;u<e.length;u++)t+=e[u].dataCount;if(n.getLengthInBits()>8*t)throw Error("code length overflow. ("+n.getLengthInBits()+">"+8*t+")");for(n.getLengthInBits()+4<=8*t&&n.put(0,4);0!=n.getLengthInBits()%8;)n.putBit(!1);for(;!(n.getLengthInBits()>=8*t)&&(n.put(o.PAD0,8),!(n.getLengthInBits()>=8*t));)n.put(o.PAD1,8);return o.createBytes(n,e)},o.createBytes=function(t,e){for(var r=0,o=0,i=0,s=Array(e.length),u=Array(e.length),h=0;h<e.length;h++){var l=e[h].dataCount,g=e[h].totalCount-l,o=Math.max(o,l),i=Math.max(i,g);s[h]=Array(l);for(var f=0;f<s[h].length;f++)s[h][f]=255&t.buffer[f+r];for(r+=l,f=a.getErrorCorrectPolynomial(g),l=new n(s[h],f.getLength()-1).mod(f),u[h]=Array(f.getLength()-1),f=0;f<u[h].length;f++)g=f+l.getLength()-u[h].length,u[h][f]=g>=0?l.get(g):0}for(f=h=0;f<e.length;f++)h+=e[f].totalCount;for(r=Array(h),f=l=0;o>f;f++)for(h=0;h<e.length;h++)f<s[h].length&&(r[l++]=s[h][f]);for(f=0;i>f;f++)for(h=0;h<e.length;h++)f<u[h].length&&(r[l++]=u[h][f]);return r},u=4;for(var a={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(t){for(var e=t<<10;0<=a.getBCHDigit(e)-a.getBCHDigit(a.G15);)e^=a.G15<<a.getBCHDigit(e)-a.getBCHDigit(a.G15);return(t<<10|e)^a.G15_MASK},getBCHTypeNumber:function(t){for(var e=t<<12;0<=a.getBCHDigit(e)-a.getBCHDigit(a.G18);)e^=a.G18<<a.getBCHDigit(e)-a.getBCHDigit(a.G18);return t<<12|e},getBCHDigit:function(t){for(var e=0;0!=t;)e++,t>>>=1;return e},getPatternPosition:function(t){return a.PATTERN_POSITION_TABLE[t-1]},getMask:function(t,e,r){switch(t){case 0:return 0==(e+r)%2;case 1:return 0==e%2;case 2:return 0==r%3;case 3:return 0==(e+r)%3;case 4:return 0==(Math.floor(e/2)+Math.floor(r/3))%2;case 5:return 0==e*r%2+e*r%3;case 6:return 0==(e*r%2+e*r%3)%2;case 7:return 0==(e*r%3+(e+r)%2)%2;default:throw Error("bad maskPattern:"+t)}},getErrorCorrectPolynomial:function(t){for(var e=new n([1],0),r=0;t>r;r++)e=e.multiply(new n([1,h.gexp(r)],0));return e},getLengthInBits:function(t,e){if(e>=1&&10>e)switch(t){case 1:return 10;case 2:return 9;case u:return 8;case 8:return 8;default:throw Error("mode:"+t)}else if(27>e)switch(t){case 1:return 12;case 2:return 11;case u:return 16;case 8:return 10;default:throw Error("mode:"+t)}else{if(!(41>e))throw Error("type:"+e);switch(t){case 1:return 14;case 2:return 13;case u:return 16;case 8:return 12;default:throw Error("mode:"+t)}}},getLostPoint:function(t){for(var e=t.getModuleCount(),r=0,o=0;e>o;o++)for(var n=0;e>n;n++){for(var i=0,s=t.isDark(o,n),u=-1;1>=u;u++)if(!(0>o+u||o+u>=e))for(var a=-1;1>=a;a++)0>n+a||n+a>=e||0==u&&0==a||s==t.isDark(o+u,n+a)&&i++;i>5&&(r+=3+i-5)}for(o=0;e-1>o;o++)for(n=0;e-1>n;n++)i=0,t.isDark(o,n)&&i++,t.isDark(o+1,n)&&i++,t.isDark(o,n+1)&&i++,t.isDark(o+1,n+1)&&i++,(0==i||4==i)&&(r+=3);for(o=0;e>o;o++)for(n=0;e-6>n;n++)t.isDark(o,n)&&!t.isDark(o,n+1)&&t.isDark(o,n+2)&&t.isDark(o,n+3)&&t.isDark(o,n+4)&&!t.isDark(o,n+5)&&t.isDark(o,n+6)&&(r+=40);for(n=0;e>n;n++)for(o=0;e-6>o;o++)t.isDark(o,n)&&!t.isDark(o+1,n)&&t.isDark(o+2,n)&&t.isDark(o+3,n)&&t.isDark(o+4,n)&&!t.isDark(o+5,n)&&t.isDark(o+6,n)&&(r+=40);for(n=i=0;e>n;n++)for(o=0;e>o;o++)t.isDark(o,n)&&i++;return t=Math.abs(100*i/e/e-50)/5,r+10*t}},h={glog:function(t){if(1>t)throw Error("glog("+t+")");return h.LOG_TABLE[t]},gexp:function(t){for(;0>t;)t+=255;for(;t>=256;)t-=255;return h.EXP_TABLE[t]},EXP_TABLE:Array(256),LOG_TABLE:Array(256)},l=0;8>l;l++)h.EXP_TABLE[l]=1<<l;for(l=8;256>l;l++)h.EXP_TABLE[l]=h.EXP_TABLE[l-4]^h.EXP_TABLE[l-5]^h.EXP_TABLE[l-6]^h.EXP_TABLE[l-8];for(l=0;255>l;l++)h.LOG_TABLE[h.EXP_TABLE[l]]=l;return n.prototype={get:function(t){return this.num[t]},getLength:function(){return this.num.length},multiply:function(t){for(var e=Array(this.getLength()+t.getLength()-1),r=0;r<this.getLength();r++)for(var o=0;o<t.getLength();o++)e[r+o]^=h.gexp(h.glog(this.get(r))+h.glog(t.get(o)));return new n(e,0)},mod:function(t){if(0>this.getLength()-t.getLength())return this;for(var e=h.glog(this.get(0))-h.glog(t.get(0)),r=Array(this.getLength()),o=0;o<this.getLength();o++)r[o]=this.get(o);for(o=0;o<t.getLength();o++)r[o]^=h.gexp(h.glog(t.get(o))+e);return new n(r,0).mod(t)}},i.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],i.getRSBlocks=function(t,e){var r=i.getRsBlockTable(t,e);if(void 0==r)throw Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+e);for(var o=r.length/3,n=[],s=0;o>s;s++)for(var u=r[3*s+0],a=r[3*s+1],h=r[3*s+2],l=0;u>l;l++)n.push(new i(a,h));return n},i.getRsBlockTable=function(t,e){switch(e){case 1:return i.RS_BLOCK_TABLE[4*(t-1)+0];case 0:return i.RS_BLOCK_TABLE[4*(t-1)+1];case 3:return i.RS_BLOCK_TABLE[4*(t-1)+2];case 2:return i.RS_BLOCK_TABLE[4*(t-1)+3]}},s.prototype={get:function(t){return 1==(this.buffer[Math.floor(t/8)]>>>7-t%8&1)},put:function(t,e){for(var r=0;e>r;r++)this.putBit(1==(t>>>e-r-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}},"string"==typeof e&&(e={text:e}),e=t.extend({},{render:"canvas",width:256,height:256,typeNumber:-1,correctLevel:2,background:"#ffffff",foreground:"#000000"},e),this.each(function(){var r;if("canvas"==e.render){r=new o(e.typeNumber,e.correctLevel),r.addData(e.text),r.make();var n=document.createElement("canvas");n.width=e.width,n.height=e.height;for(var i=n.getContext("2d"),s=e.width/r.getModuleCount(),u=e.height/r.getModuleCount(),a=0;a<r.getModuleCount();a++)for(var h=0;h<r.getModuleCount();h++){i.fillStyle=r.isDark(a,h)?e.foreground:e.background;var l=Math.ceil((h+1)*s)-Math.floor(h*s),g=Math.ceil((a+1)*s)-Math.floor(a*s);i.fillRect(Math.round(h*s),Math.round(a*u),l,g)}}else for(r=new o(e.typeNumber,e.correctLevel),r.addData(e.text),r.make(),n=t("<table></table>").css("width",e.width+"px").css("height",e.height+"px").css("border","0px").css("border-collapse","collapse").css("background-color",e.background),i=e.width/r.getModuleCount(),s=e.height/r.getModuleCount(),u=0;u<r.getModuleCount();u++)for(a=t("<tr></tr>").css("height",s+"px").appendTo(n),h=0;h<r.getModuleCount();h++)t("<td></td>").css("width",i+"px").css("background-color",r.isDark(u,h)?e.foreground:e.background).appendTo(a);r=n,jQuery(r).appendTo(this)})}}(jQuery);